(function() {
	'use strict';

	loadingInterceptor.$inject = ["$q", "$rootScope", "$log"];
	angular
	.module('ngMeumobi.Utils.loading', [])
	.factory('loadingInterceptor', loadingInterceptor);
	
	function loadingInterceptor($q, $rootScope, $log) {
		
		var numLoadings = 0;
		
		return {
			request: function(config) {
        if (!numLoadings++) {
          $rootScope.$broadcast('loading:start');
        }

				return config || $q.when(config);
			},
			response: function(response) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}

				return response || $q.when(response);
			},
			requestError: function(request) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}

				return $q.reject(request);
			},
			responseError: function(response) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}
				
				return $q.reject(response);
			}
		};
	}
})();

(function() {
	'use strict';

	angular
	.module('ngMeumobi.Utils.calendar', [])
	.factory('meuCalendar', ['$q', '$window', 'striptagsFilter', 'br2nlFilter', meuCalendar]);
  
  /*
    cordova plugin add https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin.git
    If start and end_date equal 00:00 then the event occurs all day long
  */
  
  function meuCalendar($q, $window, striptags, br2nl) {
    
    var service = {};
    
    service.createEventInteractively = createEventInteractively;
    
    return service;
    
    function createEventInteractively(options) {
      var d = $q.defer(),
        defaultOptions = {
          title: null,
          address: null,
          description: null,
          start_date: null,
          end_date: null
        };

      defaultOptions = angular.extend(defaultOptions, options);

      $window.plugins.calendar.createEventInteractively(
        striptags(defaultOptions.title),
        striptags(defaultOptions.address),
        striptags(br2nl(defaultOptions.description)),
        new Date(defaultOptions.start_date  * 1000),
        new Date(defaultOptions.end_date  * 1000),
        function (message) {
          d.resolve(message);
        }, function (error) {
          d.reject(error);
        }
      );

      return d.promise;
    }
  }
})();
(function() {
	'use strict';
  
	googleAnalyticsCordova.$inject = ["$cordovaGoogleAnalytics", "$log"];
	googleAnalytics.$inject = ["$log"];
  $cordovaGoogleAnalytics.$inject = ["$q", "$window"];
	meuAnalytics.$inject = ["$injector", "$window"];
	angular
	.module('ngMeumobi.Utils.analytics', [])
	.factory('googleAnalyticsCordova', googleAnalyticsCordova)
	.factory('googleAnalytics', googleAnalytics)
  .factory('$cordovaGoogleAnalytics', $cordovaGoogleAnalytics)
	.factory('meuAnalytics', meuAnalytics);
  
  /*
    Inspired by ngCordova
    We've extracted only required methods 
  
    install   :     cordova plugin add https://github.com/danwilson/google-analytics-plugin.git
  */

  function $cordovaGoogleAnalytics($q, $window) {
    
    var service = {};
    
    service.startTrackerWithId = startTrackerWithId;
    service.debugMode = debugMode;
    service.trackView = trackView;
    service.trackEvent = trackEvent;
    
    return service;

    function startTrackerWithId(id) {
      var d = $q.defer();

      $window.analytics.startTrackerWithId(id, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function debugMode() {
      var d = $q.defer();

      $window.analytics.debugMode(function (response) {
        d.resolve(response);
      }, function () {
        d.reject();
      });

      return d.promise;
    }

    function trackView(screenName) {
      var d = $q.defer();

      $window.analytics.trackView(screenName, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function trackEvent(category, action, label, value) {
      var d = $q.defer();

      $window.analytics.trackEvent(category, action, label, value, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function trackException(description, fatal) {
      var d = $q.defer();

      $window.analytics.trackException(description, fatal, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

  }
		
	function googleAnalyticsCordova($cordovaGoogleAnalytics, $log) {
    
    var service = {};
    
    service.init = init;
    service.trackView = $cordovaGoogleAnalytics.trackView;
    service.trackEvent = $cordovaGoogleAnalytics.trackEvent;
    
    return service;
    
    function init(trackId) {
        $cordovaGoogleAnalytics.debugMode();
        $cordovaGoogleAnalytics.startTrackerWithId(trackId);
        $cordovaGoogleAnalytics.trackView('Home');
    }
	}
  
	function googleAnalytics($log) {
    
    var service = {};
    
    service.init = init;
    service.trackView = trackView;
    
    return service;
    
    function init(trackId) {
      $log.debug('Google Analytics track Id: ' + trackId);
    }
    
    function trackView(title) {
      $log.debug('Tracking Page: ' + title);
    }
	}
  
	function meuAnalytics($injector, $window) {

		if ($window.cordova) {
			return $injector.get('googleAnalyticsCordova');
		} else {
		  return $injector.get('googleAnalytics');
		}
	}
})();
/* global angular */
/* eslint no-undef: "error" */
(function () {
  'use strict';

  angular.module('ngMeumobi.Utils.filters', [])
  .filter('isEmpty', isEmpty)
  .filter('br2nl', br2nl)
  .filter('striptags', striptags);

  function isEmpty() {
    return function (obj) {
      return !Object.keys(obj).length;
    };
  }

  function br2nl() {
    return function (text) {
      return text.replace(/<br\s*[\/]?>/gi, '\n');
    };
  }

  function striptags() {
    return function (text) {
      return angular
          .element('<div/>')
          .html(text)
          .text();
    };
  }
})();

/* global angular */
/* eslint no-undef: "error" */
/*
  TODO: should release minified (.min.js) and not (.js)
*/
(function () {
  'use strict';

  angular.module('ngMeumobi.Utils', [
    //'ngMeumobi.Utils.files',
    //'ngMeumobi.Utils.api',
    'ngMeumobi.Utils.loading',
    //'ngMeumobi.Utils.connection',
    'ngMeumobi.Utils.calendar',
    'ngMeumobi.Utils.analytics',
    //'ngMeumobi.Utils.filters'
  ]);
  
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvYWRpbmcuanMiLCJDYWxlbmRhci5qcyIsIkFuYWx5dGljcy5qcyIsIm1ldS1maWx0ZXJzLmpzIiwibW9kdWxlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLENBQUEsV0FBQTtDQUNBOzs7Q0FFQTtFQUNBLE9BQUEsMkJBQUE7RUFDQSxRQUFBLHNCQUFBOztDQUVBLFNBQUEsbUJBQUEsSUFBQSxZQUFBLE1BQUE7O0VBRUEsSUFBQSxjQUFBOztFQUVBLE9BQUE7R0FDQSxTQUFBLFNBQUEsUUFBQTtRQUNBLElBQUEsQ0FBQSxlQUFBO1VBQ0EsV0FBQSxXQUFBOzs7SUFHQSxPQUFBLFVBQUEsR0FBQSxLQUFBOztHQUVBLFVBQUEsU0FBQSxVQUFBO0lBQ0EsSUFBQSxFQUFBLEVBQUEsY0FBQTtLQUNBLFdBQUEsV0FBQTs7O0lBR0EsT0FBQSxZQUFBLEdBQUEsS0FBQTs7R0FFQSxjQUFBLFNBQUEsU0FBQTtJQUNBLElBQUEsRUFBQSxFQUFBLGNBQUE7S0FDQSxXQUFBLFdBQUE7OztJQUdBLE9BQUEsR0FBQSxPQUFBOztHQUVBLGVBQUEsU0FBQSxVQUFBO0lBQ0EsSUFBQSxFQUFBLEVBQUEsY0FBQTtLQUNBLFdBQUEsV0FBQTs7O0lBR0EsT0FBQSxHQUFBLE9BQUE7Ozs7OztBQ3RDQSxDQUFBLFdBQUE7Q0FDQTs7Q0FFQTtFQUNBLE9BQUEsNEJBQUE7RUFDQSxRQUFBLGVBQUEsQ0FBQSxNQUFBLFdBQUEsbUJBQUEsZUFBQTs7Ozs7OztFQU9BLFNBQUEsWUFBQSxJQUFBLFNBQUEsV0FBQSxPQUFBOztJQUVBLElBQUEsVUFBQTs7SUFFQSxRQUFBLDJCQUFBOztJQUVBLE9BQUE7O0lBRUEsU0FBQSx5QkFBQSxTQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7UUFDQSxpQkFBQTtVQUNBLE9BQUE7VUFDQSxTQUFBO1VBQ0EsYUFBQTtVQUNBLFlBQUE7VUFDQSxVQUFBOzs7TUFHQSxpQkFBQSxRQUFBLE9BQUEsZ0JBQUE7O01BRUEsUUFBQSxRQUFBLFNBQUE7UUFDQSxVQUFBLGVBQUE7UUFDQSxVQUFBLGVBQUE7UUFDQSxVQUFBLE1BQUEsZUFBQTtRQUNBLElBQUEsS0FBQSxlQUFBLGNBQUE7UUFDQSxJQUFBLEtBQUEsZUFBQSxZQUFBO1FBQ0EsVUFBQSxTQUFBO1VBQ0EsRUFBQSxRQUFBO1dBQ0EsVUFBQSxPQUFBO1VBQ0EsRUFBQSxPQUFBOzs7O01BSUEsT0FBQSxFQUFBOzs7O0FDN0NBLENBQUEsV0FBQTtDQUNBOzs7Ozs7Q0FFQTtFQUNBLE9BQUEsNkJBQUE7RUFDQSxRQUFBLDBCQUFBO0VBQ0EsUUFBQSxtQkFBQTtHQUNBLFFBQUEsMkJBQUE7RUFDQSxRQUFBLGdCQUFBOzs7Ozs7Ozs7RUFTQSxTQUFBLHdCQUFBLElBQUEsU0FBQTs7SUFFQSxJQUFBLFVBQUE7O0lBRUEsUUFBQSxxQkFBQTtJQUNBLFFBQUEsWUFBQTtJQUNBLFFBQUEsWUFBQTtJQUNBLFFBQUEsYUFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsbUJBQUEsSUFBQTtNQUNBLElBQUEsSUFBQSxHQUFBOztNQUVBLFFBQUEsVUFBQSxtQkFBQSxJQUFBLFVBQUEsVUFBQTtRQUNBLEVBQUEsUUFBQTtTQUNBLFVBQUEsT0FBQTtRQUNBLEVBQUEsT0FBQTs7O01BR0EsT0FBQSxFQUFBOzs7SUFHQSxTQUFBLFlBQUE7TUFDQSxJQUFBLElBQUEsR0FBQTs7TUFFQSxRQUFBLFVBQUEsVUFBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxZQUFBO1FBQ0EsRUFBQTs7O01BR0EsT0FBQSxFQUFBOzs7SUFHQSxTQUFBLFVBQUEsWUFBQTtNQUNBLElBQUEsSUFBQSxHQUFBOztNQUVBLFFBQUEsVUFBQSxVQUFBLFlBQUEsVUFBQSxVQUFBO1FBQ0EsRUFBQSxRQUFBO1NBQ0EsVUFBQSxPQUFBO1FBQ0EsRUFBQSxPQUFBOzs7TUFHQSxPQUFBLEVBQUE7OztJQUdBLFNBQUEsV0FBQSxVQUFBLFFBQUEsT0FBQSxPQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7O01BRUEsUUFBQSxVQUFBLFdBQUEsVUFBQSxRQUFBLE9BQUEsT0FBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxVQUFBLE9BQUE7UUFDQSxFQUFBLE9BQUE7OztNQUdBLE9BQUEsRUFBQTs7O0lBR0EsU0FBQSxlQUFBLGFBQUEsT0FBQTtNQUNBLElBQUEsSUFBQSxHQUFBOztNQUVBLFFBQUEsVUFBQSxlQUFBLGFBQUEsT0FBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxVQUFBLE9BQUE7UUFDQSxFQUFBLE9BQUE7OztNQUdBLE9BQUEsRUFBQTs7Ozs7Q0FLQSxTQUFBLHVCQUFBLHlCQUFBLE1BQUE7O0lBRUEsSUFBQSxVQUFBOztJQUVBLFFBQUEsT0FBQTtJQUNBLFFBQUEsWUFBQSx3QkFBQTtJQUNBLFFBQUEsYUFBQSx3QkFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsS0FBQSxTQUFBO1FBQ0Esd0JBQUE7UUFDQSx3QkFBQSxtQkFBQTtRQUNBLHdCQUFBLFVBQUE7Ozs7Q0FJQSxTQUFBLGdCQUFBLE1BQUE7O0lBRUEsSUFBQSxVQUFBOztJQUVBLFFBQUEsT0FBQTtJQUNBLFFBQUEsWUFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsS0FBQSxTQUFBO01BQ0EsS0FBQSxNQUFBLGdDQUFBOzs7SUFHQSxTQUFBLFVBQUEsT0FBQTtNQUNBLEtBQUEsTUFBQSxvQkFBQTs7OztDQUlBLFNBQUEsYUFBQSxXQUFBLFNBQUE7O0VBRUEsSUFBQSxRQUFBLFNBQUE7R0FDQSxPQUFBLFVBQUEsSUFBQTtTQUNBO0lBQ0EsT0FBQSxVQUFBLElBQUE7Ozs7OztBQ2hJQSxDQUFBLFlBQUE7RUFDQTs7RUFFQSxRQUFBLE9BQUEsMkJBQUE7R0FDQSxPQUFBLFdBQUE7R0FDQSxPQUFBLFNBQUE7R0FDQSxPQUFBLGFBQUE7O0VBRUEsU0FBQSxVQUFBO0lBQ0EsT0FBQSxVQUFBLEtBQUE7TUFDQSxPQUFBLENBQUEsT0FBQSxLQUFBLEtBQUE7Ozs7RUFJQSxTQUFBLFFBQUE7SUFDQSxPQUFBLFVBQUEsTUFBQTtNQUNBLE9BQUEsS0FBQSxRQUFBLGtCQUFBOzs7O0VBSUEsU0FBQSxZQUFBO0lBQ0EsT0FBQSxVQUFBLE1BQUE7TUFDQSxPQUFBO1dBQ0EsUUFBQTtXQUNBLEtBQUE7V0FDQTs7Ozs7Ozs7OztBQ3RCQSxDQUFBLFlBQUE7RUFDQTs7RUFFQSxRQUFBLE9BQUEsbUJBQUE7OztJQUdBOztJQUVBO0lBQ0E7Ozs7O0FBS0EiLCJmaWxlIjoibmctbWV1bW9iaS11dGlscy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyXG5cdC5tb2R1bGUoJ25nTWV1bW9iaS5VdGlscy5sb2FkaW5nJywgW10pXG5cdC5mYWN0b3J5KCdsb2FkaW5nSW50ZXJjZXB0b3InLCBsb2FkaW5nSW50ZXJjZXB0b3IpO1xuXHRcblx0ZnVuY3Rpb24gbG9hZGluZ0ludGVyY2VwdG9yKCRxLCAkcm9vdFNjb3BlLCAkbG9nKSB7XG5cdFx0XG5cdFx0dmFyIG51bUxvYWRpbmdzID0gMDtcblx0XHRcblx0XHRyZXR1cm4ge1xuXHRcdFx0cmVxdWVzdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIGlmICghbnVtTG9hZGluZ3MrKykge1xuICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZGluZzpzdGFydCcpO1xuICAgICAgICB9XG5cblx0XHRcdFx0cmV0dXJuIGNvbmZpZyB8fCAkcS53aGVuKGNvbmZpZyk7XG5cdFx0XHR9LFxuXHRcdFx0cmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdGlmICghKC0tbnVtTG9hZGluZ3MpKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkaW5nOnN0b3AnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcblx0XHRcdH0sXG5cdFx0XHRyZXF1ZXN0RXJyb3I6IGZ1bmN0aW9uKHJlcXVlc3QpIHtcblx0XHRcdFx0aWYgKCEoLS1udW1Mb2FkaW5ncykpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRpbmc6c3RvcCcpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuICRxLnJlamVjdChyZXF1ZXN0KTtcblx0XHRcdH0sXG5cdFx0XHRyZXNwb25zZUVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRpZiAoISgtLW51bUxvYWRpbmdzKSkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZGluZzpzdG9wJyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyXG5cdC5tb2R1bGUoJ25nTWV1bW9iaS5VdGlscy5jYWxlbmRhcicsIFtdKVxuXHQuZmFjdG9yeSgnbWV1Q2FsZW5kYXInLCBbJyRxJywgJyR3aW5kb3cnLCAnc3RyaXB0YWdzRmlsdGVyJywgJ2JyMm5sRmlsdGVyJywgbWV1Q2FsZW5kYXJdKTtcbiAgXG4gIC8qXG4gICAgY29yZG92YSBwbHVnaW4gYWRkIGh0dHBzOi8vZ2l0aHViLmNvbS9FZGR5VmVyYnJ1Z2dlbi9DYWxlbmRhci1QaG9uZUdhcC1QbHVnaW4uZ2l0XG4gICAgSWYgc3RhcnQgYW5kIGVuZF9kYXRlIGVxdWFsIDAwOjAwIHRoZW4gdGhlIGV2ZW50IG9jY3VycyBhbGwgZGF5IGxvbmdcbiAgKi9cbiAgXG4gIGZ1bmN0aW9uIG1ldUNhbGVuZGFyKCRxLCAkd2luZG93LCBzdHJpcHRhZ3MsIGJyMm5sKSB7XG4gICAgXG4gICAgdmFyIHNlcnZpY2UgPSB7fTtcbiAgICBcbiAgICBzZXJ2aWNlLmNyZWF0ZUV2ZW50SW50ZXJhY3RpdmVseSA9IGNyZWF0ZUV2ZW50SW50ZXJhY3RpdmVseTtcbiAgICBcbiAgICByZXR1cm4gc2VydmljZTtcbiAgICBcbiAgICBmdW5jdGlvbiBjcmVhdGVFdmVudEludGVyYWN0aXZlbHkob3B0aW9ucykge1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpLFxuICAgICAgICBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgICB0aXRsZTogbnVsbCxcbiAgICAgICAgICBhZGRyZXNzOiBudWxsLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBudWxsLFxuICAgICAgICAgIHN0YXJ0X2RhdGU6IG51bGwsXG4gICAgICAgICAgZW5kX2RhdGU6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZChkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICR3aW5kb3cucGx1Z2lucy5jYWxlbmRhci5jcmVhdGVFdmVudEludGVyYWN0aXZlbHkoXG4gICAgICAgIHN0cmlwdGFncyhkZWZhdWx0T3B0aW9ucy50aXRsZSksXG4gICAgICAgIHN0cmlwdGFncyhkZWZhdWx0T3B0aW9ucy5hZGRyZXNzKSxcbiAgICAgICAgc3RyaXB0YWdzKGJyMm5sKGRlZmF1bHRPcHRpb25zLmRlc2NyaXB0aW9uKSksXG4gICAgICAgIG5ldyBEYXRlKGRlZmF1bHRPcHRpb25zLnN0YXJ0X2RhdGUgICogMTAwMCksXG4gICAgICAgIG5ldyBEYXRlKGRlZmF1bHRPcHRpb25zLmVuZF9kYXRlICAqIDEwMDApLFxuICAgICAgICBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgIGQucmVzb2x2ZShtZXNzYWdlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcbiAgXG5cdGFuZ3VsYXJcblx0Lm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzLmFuYWx5dGljcycsIFtdKVxuXHQuZmFjdG9yeSgnZ29vZ2xlQW5hbHl0aWNzQ29yZG92YScsIGdvb2dsZUFuYWx5dGljc0NvcmRvdmEpXG5cdC5mYWN0b3J5KCdnb29nbGVBbmFseXRpY3MnLCBnb29nbGVBbmFseXRpY3MpXG4gIC5mYWN0b3J5KCckY29yZG92YUdvb2dsZUFuYWx5dGljcycsICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzKVxuXHQuZmFjdG9yeSgnbWV1QW5hbHl0aWNzJywgbWV1QW5hbHl0aWNzKTtcbiAgXG4gIC8qXG4gICAgSW5zcGlyZWQgYnkgbmdDb3Jkb3ZhXG4gICAgV2UndmUgZXh0cmFjdGVkIG9ubHkgcmVxdWlyZWQgbWV0aG9kcyBcbiAgXG4gICAgaW5zdGFsbCAgIDogICAgIGNvcmRvdmEgcGx1Z2luIGFkZCBodHRwczovL2dpdGh1Yi5jb20vZGFud2lsc29uL2dvb2dsZS1hbmFseXRpY3MtcGx1Z2luLmdpdFxuICAqL1xuXG4gIGZ1bmN0aW9uICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzKCRxLCAkd2luZG93KSB7XG4gICAgXG4gICAgdmFyIHNlcnZpY2UgPSB7fTtcbiAgICBcbiAgICBzZXJ2aWNlLnN0YXJ0VHJhY2tlcldpdGhJZCA9IHN0YXJ0VHJhY2tlcldpdGhJZDtcbiAgICBzZXJ2aWNlLmRlYnVnTW9kZSA9IGRlYnVnTW9kZTtcbiAgICBzZXJ2aWNlLnRyYWNrVmlldyA9IHRyYWNrVmlldztcbiAgICBzZXJ2aWNlLnRyYWNrRXZlbnQgPSB0cmFja0V2ZW50O1xuICAgIFxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gc3RhcnRUcmFja2VyV2l0aElkKGlkKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICR3aW5kb3cuYW5hbHl0aWNzLnN0YXJ0VHJhY2tlcldpdGhJZChpZCwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVidWdNb2RlKCkge1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAkd2luZG93LmFuYWx5dGljcy5kZWJ1Z01vZGUoZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGQucmVqZWN0KCk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cmFja1ZpZXcoc2NyZWVuTmFtZSkge1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAkd2luZG93LmFuYWx5dGljcy50cmFja1ZpZXcoc2NyZWVuTmFtZSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIGQucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkLnByb21pc2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdHJhY2tFdmVudChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUpIHtcbiAgICAgIHZhciBkID0gJHEuZGVmZXIoKTtcblxuICAgICAgJHdpbmRvdy5hbmFseXRpY3MudHJhY2tFdmVudChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyYWNrRXhjZXB0aW9uKGRlc2NyaXB0aW9uLCBmYXRhbCkge1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAkd2luZG93LmFuYWx5dGljcy50cmFja0V4Y2VwdGlvbihkZXNjcmlwdGlvbiwgZmF0YWwsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cblxuICB9XG5cdFx0XG5cdGZ1bmN0aW9uIGdvb2dsZUFuYWx5dGljc0NvcmRvdmEoJGNvcmRvdmFHb29nbGVBbmFseXRpY3MsICRsb2cpIHtcbiAgICBcbiAgICB2YXIgc2VydmljZSA9IHt9O1xuICAgIFxuICAgIHNlcnZpY2UuaW5pdCA9IGluaXQ7XG4gICAgc2VydmljZS50cmFja1ZpZXcgPSAkY29yZG92YUdvb2dsZUFuYWx5dGljcy50cmFja1ZpZXc7XG4gICAgc2VydmljZS50cmFja0V2ZW50ID0gJGNvcmRvdmFHb29nbGVBbmFseXRpY3MudHJhY2tFdmVudDtcbiAgICBcbiAgICByZXR1cm4gc2VydmljZTtcbiAgICBcbiAgICBmdW5jdGlvbiBpbml0KHRyYWNrSWQpIHtcbiAgICAgICAgJGNvcmRvdmFHb29nbGVBbmFseXRpY3MuZGVidWdNb2RlKCk7XG4gICAgICAgICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzLnN0YXJ0VHJhY2tlcldpdGhJZCh0cmFja0lkKTtcbiAgICAgICAgJGNvcmRvdmFHb29nbGVBbmFseXRpY3MudHJhY2tWaWV3KCdIb21lJyk7XG4gICAgfVxuXHR9XG4gIFxuXHRmdW5jdGlvbiBnb29nbGVBbmFseXRpY3MoJGxvZykge1xuICAgIFxuICAgIHZhciBzZXJ2aWNlID0ge307XG4gICAgXG4gICAgc2VydmljZS5pbml0ID0gaW5pdDtcbiAgICBzZXJ2aWNlLnRyYWNrVmlldyA9IHRyYWNrVmlldztcbiAgICBcbiAgICByZXR1cm4gc2VydmljZTtcbiAgICBcbiAgICBmdW5jdGlvbiBpbml0KHRyYWNrSWQpIHtcbiAgICAgICRsb2cuZGVidWcoJ0dvb2dsZSBBbmFseXRpY3MgdHJhY2sgSWQ6ICcgKyB0cmFja0lkKTtcbiAgICB9XG4gICAgXG4gICAgZnVuY3Rpb24gdHJhY2tWaWV3KHRpdGxlKSB7XG4gICAgICAkbG9nLmRlYnVnKCdUcmFja2luZyBQYWdlOiAnICsgdGl0bGUpO1xuICAgIH1cblx0fVxuICBcblx0ZnVuY3Rpb24gbWV1QW5hbHl0aWNzKCRpbmplY3RvciwgJHdpbmRvdykge1xuXG5cdFx0aWYgKCR3aW5kb3cuY29yZG92YSkge1xuXHRcdFx0cmV0dXJuICRpbmplY3Rvci5nZXQoJ2dvb2dsZUFuYWx5dGljc0NvcmRvdmEnKTtcblx0XHR9IGVsc2Uge1xuXHRcdCAgcmV0dXJuICRpbmplY3Rvci5nZXQoJ2dvb2dsZUFuYWx5dGljcycpO1xuXHRcdH1cblx0fVxufSkoKTsiLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuLyogZXNsaW50IG5vLXVuZGVmOiBcImVycm9yXCIgKi9cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzLmZpbHRlcnMnLCBbXSlcbiAgLmZpbHRlcignaXNFbXB0eScsIGlzRW1wdHkpXG4gIC5maWx0ZXIoJ2JyMm5sJywgYnIybmwpXG4gIC5maWx0ZXIoJ3N0cmlwdGFncycsIHN0cmlwdGFncyk7XG5cbiAgZnVuY3Rpb24gaXNFbXB0eSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgcmV0dXJuICFPYmplY3Qua2V5cyhvYmopLmxlbmd0aDtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gYnIybmwoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC88YnJcXHMqW1xcL10/Pi9naSwgJ1xcbicpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBzdHJpcHRhZ3MoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gYW5ndWxhclxuICAgICAgICAgIC5lbGVtZW50KCc8ZGl2Lz4nKVxuICAgICAgICAgIC5odG1sKHRleHQpXG4gICAgICAgICAgLnRleHQoKTtcbiAgICB9O1xuICB9XG59KSgpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbi8qIGVzbGludCBuby11bmRlZjogXCJlcnJvclwiICovXG4vKlxuICBUT0RPOiBzaG91bGQgcmVsZWFzZSBtaW5pZmllZCAoLm1pbi5qcykgYW5kIG5vdCAoLmpzKVxuKi9cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzJywgW1xuICAgIC8vJ25nTWV1bW9iaS5VdGlscy5maWxlcycsXG4gICAgLy8nbmdNZXVtb2JpLlV0aWxzLmFwaScsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5sb2FkaW5nJyxcbiAgICAvLyduZ01ldW1vYmkuVXRpbHMuY29ubmVjdGlvbicsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5jYWxlbmRhcicsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5hbmFseXRpY3MnLFxuICAgIC8vJ25nTWV1bW9iaS5VdGlscy5maWx0ZXJzJ1xuICBdKTtcbiAgXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
