(function() {
	'use strict';

	angular
	.module('ngMeumobi.Utils.socialSharing', [])
	.factory('meuSocialSharing', ['$q', '$window', 'striptagsFilter', 'br2nlFilter', '$log', meuSocialSharing]);
  
  /*
    cordova plugin add https://github.com/EddyVerbruggen/SocialSharing-PhoneGap-Plugin
  */
  
  function meuSocialSharing($q, $window, striptags, br2nl, $log) {
    
    var service = {};
    var options = {
      postfix: ''
    };
    
    service.shareItem = shareItem;
    service.shareMedia = shareMedia;
    service.setOption = setOption;
    service.setOptions = setOptions;
    service.share = share;
    service.shareViaWhatsAppToReceiver = shareViaWhatsAppToReceiver;
    
    return service;

    function setOptions(options) {
      angular.extend(options, options);
    }

    function setOption(name, value) {
      options[name] = value;
    }

		function shareViaWhatsAppToReceiver(receiver) {
      var social = $window.plugins && $window.plugins.socialsharing;
		  
      social.shareViaWhatsAppToReceiver(receiver, 'Message via WhatsApp', null /* img */, null /* url */, function() {$log.debug('share ok');});
		}
    
    function shareItem(item) {
			
			var params = {
			  message: item.description,
        subject: item.title,
        files: [],
        url: item.hasOwnProperty('link') ? item.link : null
			};

      if (item.thumbnails && item.thumbnails.length > 0) {
				params.files.push(item.thumbnails[0].url);
			}

			return share(params);
		}

		function shareMedia(media) {

			var params = {
			  message: media.title,
        subject: media.title,
        files: [],
        url: media.url
			};
			
			// If media is saved locally (media.path) then share it
			// Else share its link (media.url)
			// Couldn't share together local pdf and link
			if (media.hasOwnProperty('fullPath')) {
				params.files.push(media.fullPath);
				params.url = null;
			} else if (media.thumbnails && media.thumbnails.length > 0) {
				params.files.push(media.thumbnails[0].url);
			}
			
			return share(params);
		}
		
		function share(params) {
    /*
      this is the complete list of currently supported params you can pass to the plugin (all optional)
      var options = {
        message: 'share this', // not supported on some apps (Facebook, Instagram)
        subject: 'the subject', // fi. for email
        files: ['', ''], // an array of filenames either locally or remotely
        url: 'https://www.website.com/foo/#bar?a=b',
        chooserTitle: 'Pick an app' // Android only, you can override the default share sheet title
      }
    */
      var d = $q.defer();			
      var social = $window.plugins && $window.plugins.socialsharing;
      
      // If params.description is null
    
			if (social) {
        if (options.postfix) {
  				params.subject += options.postfix;
        }
      
        params.message = params.message && striptags(br2nl(params.message));
        params.subject = params.subject && striptags(br2nl(params.subject));
        var cb_share = {
          success: function(result) {
            d.resolve(result);
          },
          fail: function(msg) {
            d.reject(msg);
          }  
        };
        
        $log.debug('shareWithOptions');
        $log.debug(params);
        social.shareWithOptions(params, cb_share.success, cb_share.fail); 
			} else {
			  d.reject('Plugin socialsharing missing');
			}
      
      return d.promise;
		}
  }
})();
(function() {
	'use strict';

	loadingInterceptor.$inject = ["$q", "$rootScope", "$log"];
	angular
	.module('ngMeumobi.Utils.loading', [])
	.factory('loadingInterceptor', loadingInterceptor);
	
	function loadingInterceptor($q, $rootScope, $log) {
		
		var numLoadings = 0;
		
		return {
			request: function(config) {
        if (!numLoadings++) {
          $rootScope.$broadcast('loading:start');
        }

				return config || $q.when(config);
			},
			response: function(response) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}

				return response || $q.when(response);
			},
			requestError: function(request) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}

				return $q.reject(request);
			},
			responseError: function(response) {
				if (!(--numLoadings)) {
					$rootScope.$broadcast('loading:stop');
				}
				
				return $q.reject(response);
			}
		};
	}
})();

(function () {
  'use strict';
  
	mediaClickLabel.$inject = ["MIMES"];
	mediaIconClass.$inject = ["MIMES"];
angular
	.module('ngMeumobi.Utils.files', ['slugifier'])
	.constant('MIMES', {
		'application/pdf': {
			class: 'fa-file-pdf-o',
			label: 'View',
			extension: 'pdf',
			download: true
		},
		'text/html': {
			class: 'fa-rss',
			label: 'Open',
			extension: 'html',
			download: false
		},
    'application/vnd.youtube.video+html': {
			class: 'fa-youtube-play',
			label: 'Play',
			extension: 'html',
			download: false
    },
		'application/vnd.ms-excel': {
			class: 'fa-file-excel-o',
			label: 'View',
			extension: 'xls',
			download: true
		},
		'audio/mpeg': {
			class: 'fa-file-audio-o',
			label: 'Play',
			extension: 'mp3',
			download: true
		},
		'application/vnd.ms-powerpoint': {
			class: 'fa-file-powerpoint-o',
			label: 'View',
			extension: 'ppt',
			download: true,
		},
		'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': {
			class: 'fa-file-excel-o',
			label: 'View',
			extension: 'xls',
			download: true
		}
	})
	.filter('mediaClickLabel', mediaClickLabel)
	.filter('mediaIconClass', mediaIconClass) 
  .provider('meuFiles', meuFiles); 
        
  function meuFiles() {
    var fileTransfers = {};
    var files = {};
    var options = {
      localFolder: 'Downloads'
    };
    var statuses = {
      download: 'download',
      downloading: 'downloading',
      downloaded: 'downloaded'
    };
    
    this.setOptions = function(options) {
      angular.extend(options, options);
    };

    this.setOption = function(name, value) {
      options[name] = value;
    };

    this.$get = ["$q", "$log", "$window", "MIMES", "Slug", function($q, $log, $window, MIMES, Slug) {
      var api = {};
      var service = {};
      
      /**
       *  Api methods, available only on the inside the service
       */

      api.fileErrorHandler = function(e) {
      /*
        List of Errors cordova-plugin-file
        https://github.com/apache/cordova-plugin-file#list-of-error-codes-and-meanings
        For the meaning I recommend to read https://wicg.github.io/entries-api/#common-types
      */
        switch (e.code) {
          case FileError.NOT_FOUND_ERR:
            e.message = 'Requested file could not be found';
            break;
          case FileError.SECURITY_ERR:
            e.message = 'SECURITY_ERR';
            break;
          case FileError.ABORT_ERR:
            e.message = 'ABORT_ERR';
            break;
          case FileError.NOT_READABLE_ERR:
            e.message = 'NOT_READABLE_ERR';
            break;
          case FileError.ENCODING_ERR:
            e.message = 'Malformed URI';
            break;
          case FileError.NO_MODIFICATION_ALLOWED_ERR:
            e.message = 'NO_MODIFICATION_ALLOWED_ERR';
            break;
          case FileError.INVALID_STATE_ERR:
            e.message = 'INVALID_STATE_ERR';
            break;
          case FileError.SYNTAX_ERR:
            e.message = 'SYNTAX_ERR';
            break;
          case FileError.INVALID_MODIFICATION_ERR:
            e.message = 'INVALID_MODIFICATION_ERR';
            break;
          case FileError.QUOTA_EXCEEDED_ERR:
            e.message = 'QUOTA_EXCEEDED_ERR';
            break;
          case FileError.TYPE_MISMATCH_ERR:
            e.message = 'TYPE_MISMATCH_ERR';
            break;
          case FileError.PATH_EXISTS_ERR:
            e.message = 'PATH_EXISTS_ERR';
            break;
          default:
            e.message = 'Unknown Error';
            break;
        }
        $log.debug('Error: ' + e.message);
        
        return e;
      };
      
      api.fileTransferErrorHandler = function(e) {
      /*
        A FileTransferError object is passed to an error callback when an error occurs.
        https://github.com/apache/cordova-plugin-file-transfer#filetransfererror
      */
        switch (e.code) {
          case FileTransferError.FILE_NOT_FOUND_ERR:
            e.message = 'FILE_NOT_FOUND_ERR';
            break;
          case FileTransferError.INVALID_URL_ERR:
            e.message = 'INVALID_URL_ERR';
            break;
          case FileTransferError.CONNECTION_ERR:
            e.message = 'CONNECTION_ERR';
            break;
          case FileTransferError.ABORT_ERR:
            e.message = 'Operation aborted';
            break;
          case FileTransferError.NOT_MODIFIED_ERR:
            e.message = 'NOT_MODIFIED_ERR';
            break;
          default:
            e.message = 'Unknown Error';
            break;
        }
        $log.debug('Error: ' + e.message);
        
        return e;
      };

      api.getFilesFromLocalStorage = function() {
        /*
          Check if files is already loaded (if not is empty)
        TODO: is loading localStorage['files] for each media, should be optimized to only load once for all
        */
        if (!Object.keys(files).length  && localStorage['files']) { 
          var entries = angular.fromJson(localStorage['files']);
          files = api.checkRepositoryConsistency(entries);
        }
        return files;
      };
      
      api.getFileName = function(file) {
        var ext = file.extension || '';
        
        if (!ext && MIMES[file.type])
          ext = MIMES[file.type].extension;
                
        var name = file.title || '';
        
        if (!name) {
          name = md5(file.url);
        } else {
          name = Slug.slugify(name);
        }
                          
        return name + '.' + ext;
      };
      
      api.checkRepositoryConsistency = function(entries) {
        /*
          id must be equals to file.path
          and fullPath can be updated if App is updated (iOS)
        */
        var obj = {};
        Object.keys(entries).forEach(function(key,index) {
          obj[entries[key].path] = entries[key];
          obj[entries[key].path].fullPath = api.getFileFullPath(entries[key].path);
        });
        localStorage['files'] = angular.toJson(obj);

        return obj;
      };
      
      // Returns the full absolute path from the root to the FileEntry
      api.getFileFullPath = function (filePath) {
        var directory = null;
				if (device.platform == 'Android') {
					directory = cordova.file.externalDataDirectory;
				} else {
	        directory = cordova.file.dataDirectory;
				}
        return directory + filePath;
      };
      
      api.getFilePath = function (fileName) {
        return options.localFolder + '/' + fileName;
      };
      
      //add file to localstorage
      api.addFile = function(file) {
        files[file.path] = file;
        localStorage['files'] = angular.toJson(files);
      };
      
      //remove file from localstorage
      api.removeFile = function(id) {
  			delete files[id];
        localStorage['files'] = angular.toJson(files);
      };
      
      //get files handler
      api.getFileEntry = function (path) {
        var q = $q.defer();
        $window.resolveLocalFileSystemURL(
          path, 
          function(entry) {
            q.resolve(entry);
          },
          function(error) {
            $log.debug(error);
            error = api.fileErrorHandler(error);
            q.reject(error);
          }
        );
        return q.promise;
      };
      
      api.isDownloaded = function(filePath) {
        /*
          TODO: If status is downloaded but local file is missing then return FALSE
          Keep record on localstorage to appears as file already downloaded, user can re-download if needed
        */
        return !!api.getFilesFromLocalStorage()[filePath];
      };
      
      api.isDownloading = function(filePath) {
        return !!fileTransfers[filePath];     
      };
      
      api.getFileStatus = function(filePath) {
        if (api.isDownloaded(filePath)) {
          return statuses.downloaded;
        } else if (api.isDownloading(filePath)) {
          return statuses.downloading;
        } else {
          return statuses.download; 
        }
      };
    
      /**
       * Service methods, that are public and available for any resource
       */
      // File available statuses, best for debug and maitain than just string.
      
      service.download = download;
      service.decorateFile = decorateFile;
      service.remove = remove;
      service.list = api.getFilesFromLocalStorage;
      service.open = open;
      service.isDownloadable = isDownloadable;
      service.openFileOpener = openFileOpener;
      
      return service;
      
      /*
        Install: cordova plugin add cordova-plugin-file-opener2
        https://www.npmjs.com/package/cordova-plugin-file-opener2
      */
      
      function isDownloadable(file) {
        return (file.type in MIMES) ? MIMES[file.type].download : true;
      }
      
      function openFileOpener(uri, type) {
        var q = $q.defer();

        cordova.plugins.fileOpener2.open(uri, type, {
          error: function (e) {
            q.reject(e);
          }, success: function () {
            q.resolve();
          }
        });
        return q.promise;
      };
      
      function open(file) {
        var q = $q.defer();
        var cb_entry = {
          success: function(entry) {
            openFileOpener(entry.toURL(), file.type).then(
              function() {
                q.resolve();
              },
              function(e) {
                q.reject(e);
              }
            );
          },
          fail: function(e) {
            q.reject(e);
          }
        };
        
        file.fullPath = api.getFileFullPath(file.path);
        api.getFileEntry(file.fullPath)
          .then(function(entry) {
            cb_entry.success(entry);
          }, function(e) {
            cb_entry.fail(e);
          }
        );
        
        return q.promise;
      };
      
      function download(file) {
        var q = $q.defer();
        var ft = new FileTransfer();
        var uri = encodeURI(file.url);
        
        file.status = statuses.downloading;
        file.fullPath = api.getFileFullPath(file.path);
        fileTransfers[file.path] = ft;

        ft.onprogress = function (progress) {
          q.notify(progress);
        };

        q.promise.abort = function () {
          ft.abort();
        };

        var cb_download = {
          success: function(fileEntry) {
            file.status = statuses.downloaded;
						api.addFile(file);
						delete fileTransfers[file.path];
            q.resolve(file);
          },
          fail: function(error) {
            $log.debug(error);
            file.status = statuses.download;
            error = api.fileTransferErrorHandler(error);
						delete fileTransfers[file.path];
						q.reject(error);
          }
        };
        ft.download(uri, file.fullPath, cb_download.success, cb_download.fail, false);
        
        return q.promise;
      };
      
      function remove(file) {
        var q = $q.defer();

        file.fullPath = api.getFileFullPath(file.path);
        api.getFileEntry(file.fullPath)
          .then(function(entry) {
            entry.remove(
              function (status) {
                api.removeFile(file.path);
                file.status = statuses.download;
                q.resolve(file);
              },function (error) {
                q.reject(error);
              }
            );
          }, function(error) {
            file.status = statuses.download;
            q.reject(error);
          }
        );
        
        return q.promise;
      }
      
      function decorateFile(file) {
        file.name = file.name || api.getFileName(file);
        file.path = file.path || api.getFilePath(file.name);
        file.status = api.getFileStatus(file.path);
        
        /*
          If device not exists then app run on browser
        */
        if (!typeof(device)) {
          var fullPath = api.getFileFullPath(file.path);
          if (api.isDownloaded(fullPath))
            file.fullPath = fullPath;
        };

        return file;
      };
    }];
  };
  
	function mediaClickLabel(MIMES) {
		return function(type) {
			return MIMES[type] ? MIMES[type].label : 'Open';
		};
	}
	
	function mediaIconClass(MIMES) {
		return function(type) {
			return MIMES[type] ? MIMES[type].class : 'fa-external-link';
		};
	}
})();
(function() {
	'use strict';

  meuDialogs.$inject = ["$q", "$window"];
	angular
	.module('ngMeumobi.Utils.dialogs', [])
	.factory('meuDialogs', meuDialogs);
  
  /*
    install   :     cordova plugin add cordova-plugin-dialogs nl.x-services.plugins.toast
    link      :     https://github.com/apache/cordova-plugin-dialogs
    link      :     https://github.com/EddyVerbruggen/Toast-PhoneGap-Plugin  
  */
  
  function meuDialogs($q, $window) {
    
    var service = {};
    
    service.alert = alert;
    service.confirm = confirm;
    service.toast = toast;
    
    return service;
    
    function alert (message, title, buttonName) {
      var q = $q.defer();

      if (!$window.navigator.notification) {
        $window.alert(message);
        q.resolve();
      } else {
        navigator.notification.alert(message, function () {
          q.resolve();
        }, title, buttonName);
      }

      return q.promise;
    };
    
    function confirm (message, title, buttonLabels) {
      var q = $q.defer();

      if (!$window.navigator.notification) {
        if ($window.confirm(message)) {
          q.resolve(1);
        } else {
          q.resolve(2);
        }
      } else {
        navigator.notification.confirm(message, function (buttonIndex) {
          q.resolve(buttonIndex);
        }, title, buttonLabels);
      }

      return q.promise;
    };
    
    function toast (message) {
      var q = $q.defer();
			var toast = $window.plugins && $window.plugins.toast;
      
			if (toast) {
        toast.showLongBottom(message, function (response) {
          q.resolve(response);
        }, function (error) {
          q.reject(error);
        });
      } else {
        alert(message);
      }
      
      return q.promise;
    };
  }
})();
(function() {
	'use strict';

	angular
	.module('ngMeumobi.Utils.calendar', [])
	.factory('meuCalendar', ['$q', '$window', 'striptagsFilter', 'br2nlFilter', meuCalendar]);
  
  /*
    cordova plugin add https://github.com/EddyVerbruggen/Calendar-PhoneGap-Plugin.git
    If start and end_date equal 00:00 then the event occurs all day long
  */
  
  function meuCalendar($q, $window, striptags, br2nl) {
    
    var service = {};
    
    service.createEventInteractively = createEventInteractively;
    
    return service;
    
    function createEventInteractively(options) {
      var d = $q.defer(),
        defaultOptions = {
          title: null,
          address: null,
          description: '',
          start_date: null,
          end_date: null
        };

      defaultOptions = angular.extend(defaultOptions, options);

      $window.plugins.calendar.createEventInteractively(
        striptags(defaultOptions.title),
        striptags(defaultOptions.address),
        striptags(br2nl(defaultOptions.description)),
        new Date(defaultOptions.start_date  * 1000),
        new Date(defaultOptions.end_date  * 1000),
        function (message) {
          d.resolve(message);
        }, function (error) {
          d.reject(error);
        }
      );

      return d.promise;
    }
  }
})();
(function() {
	'use strict';
  
	googleAnalyticsCordova.$inject = ["$cordovaGoogleAnalytics", "$log"];
	googleAnalytics.$inject = ["$log", "$q"];
  $cordovaGoogleAnalytics.$inject = ["$q", "$window", "$log"];
	meuAnalytics.$inject = ["$injector", "$window"];
	angular
	.module('ngMeumobi.Utils.analytics', [])
	.factory('googleAnalyticsCordova', googleAnalyticsCordova)
	.factory('googleAnalytics', googleAnalytics)
  .factory('$cordovaGoogleAnalytics', $cordovaGoogleAnalytics)
	.factory('meuAnalytics', meuAnalytics);
  
  /*
    Inspired by ngCordova
    We've extracted only required methods 
  
    install   :     cordova plugin add https://github.com/danwilson/google-analytics-plugin.git
  */

  function $cordovaGoogleAnalytics($q, $window, $log) {
    
    var service = {};
    
    service.startTrackerWithId = startTrackerWithId;
    service.debugMode = debugMode;
    service.trackView = trackView;
    service.trackEvent = trackEvent;
    service.setUserId = setUserId;
    
    return service;

    function setUserId(id) {
      var d = $q.defer();

      $log.debug('Set User Id: ' + id);
      
      $window.analytics.setUserId(id, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function startTrackerWithId(id) {
      var d = $q.defer();

      $log.debug('Start tracking GA Id: ' + id);

      $window.analytics.startTrackerWithId(id, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function debugMode() {
      var d = $q.defer();

      $window.analytics.debugMode(function (response) {
        d.resolve(response);
      }, function () {
        d.reject();
      });

      return d.promise;
    }

    function trackView(screenName) {
      var d = $q.defer();
      
      $log.debug('Track View: ' + screenName);
      
      $window.analytics.trackView(screenName, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }

    function trackEvent(category, action, label, value) {
      var d = $q.defer();

      var ev = [category, action, label, value];
      $log.debug('Track Event: ' + ev.toString());
      
      $window.analytics.trackEvent(category, action, label, value, function (response) {
        d.resolve(response);
      }, function (error) {
        d.reject(error);
      });

      return d.promise;
    }
  }
		
	function googleAnalyticsCordova($cordovaGoogleAnalytics, $log) {
    
    var service = {};
    
    service.init = init;
    service.debugMode = $cordovaGoogleAnalytics.debugMode;
    service.trackView = $cordovaGoogleAnalytics.trackView;
    service.trackEvent = $cordovaGoogleAnalytics.trackEvent;
    service.startTrackerWithId = $cordovaGoogleAnalytics.startTrackerWithId;
    service.setUserId = $cordovaGoogleAnalytics.setUserId;
    
    return service;
    
    function init(trackId) {
      $cordovaGoogleAnalytics.startTrackerWithId(trackId);
    }
	}
  
	function googleAnalytics($log, $q) {
    
    var service = {};
    
    service.init = init;
    service.debugMode = debugMode;
    service.trackView = trackView;
    service.trackEvent = trackEvent;
    service.startTrackerWithId  = startTrackerWithId;
    service.setUserId = setUserId;
    
    return service;
    
    function init(trackId) {
      $log.debug('Google Analytics track Id: ' + trackId);
    }
    
    function debugMode() {
      $log.debug('Enable Debug');
    }
    
    function trackView(title) {
      $log.debug('Tracking Page: ' + title);
    }
    
    function trackEvent(category, action, label, value) {
      $log.debug('Tracking Event: ' + action);
    }
    
    function startTrackerWithId(id) {
      var msg = 'Tracking GA Id: ' + id;
      var d = $q.defer();

      d.resolve(msg);

      return d.promise;
    }
    
    function setUserId(id) {
      $log.debug('Tracking User: ' + id);
    }
	}
  
	function meuAnalytics($injector, $window) {

		if ($window.cordova) {
			return $injector.get('googleAnalyticsCordova');
		} else {
		  return $injector.get('googleAnalytics');
		}
	}
})();
/* global angular */
/* eslint no-undef: "error" */
(function () {
  'use strict';

  angular.module('ngMeumobi.Utils.filters', [])
  .filter('isEmpty', isEmpty)
  .filter('br2nl', br2nl)
  .filter('striptags', striptags);

  function isEmpty() {
    return function (obj) {
      return !Object.keys(obj).length;
    };
  }

  function br2nl() {
    return function (text) {
      return text.replace(/<br\s*[\/]?>/gi, '\n');
    };
  }

  function striptags() {
    return function (text) {
      return angular
          .element('<div/>')
          .html(text)
          .text();
    };
  }
})();

/* global angular */
/* eslint no-undef: "error" */
/*
  TODO: should release minified (.min.js) and not (.js)
*/
(function () {
  'use strict';

  angular.module('ngMeumobi.Utils', [
    //'ngMeumobi.Utils.files',
    //'ngMeumobi.Utils.api',
    'ngMeumobi.Utils.loading',
    //'ngMeumobi.Utils.connection',
    'ngMeumobi.Utils.calendar',
    'ngMeumobi.Utils.analytics',
    'ngMeumobi.Utils.socialSharing',
    'ngMeumobi.Utils.dialogs',
    'ngMeumobi.Utils.files'
    //'ngMeumobi.Utils.filters'
  ]);
  
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNvY2lhbFNoYXJpbmcuanMiLCJMb2FkaW5nLmpzIiwiRmlsZXMuanMiLCJEaWFsb2dzLmpzIiwiQ2FsZW5kYXIuanMiLCJBbmFseXRpY3MuanMiLCJtZXUtZmlsdGVycy5qcyIsIm1vZHVsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxDQUFBLFdBQUE7Q0FDQTs7Q0FFQTtFQUNBLE9BQUEsaUNBQUE7RUFDQSxRQUFBLG9CQUFBLENBQUEsTUFBQSxXQUFBLG1CQUFBLGVBQUEsUUFBQTs7Ozs7O0VBTUEsU0FBQSxpQkFBQSxJQUFBLFNBQUEsV0FBQSxPQUFBLE1BQUE7O0lBRUEsSUFBQSxVQUFBO0lBQ0EsSUFBQSxVQUFBO01BQ0EsU0FBQTs7O0lBR0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxhQUFBO0lBQ0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxhQUFBO0lBQ0EsUUFBQSxRQUFBO0lBQ0EsUUFBQSw2QkFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsV0FBQSxTQUFBO01BQ0EsUUFBQSxPQUFBLFNBQUE7OztJQUdBLFNBQUEsVUFBQSxNQUFBLE9BQUE7TUFDQSxRQUFBLFFBQUE7OztFQUdBLFNBQUEsMkJBQUEsVUFBQTtNQUNBLElBQUEsU0FBQSxRQUFBLFdBQUEsUUFBQSxRQUFBOztNQUVBLE9BQUEsMkJBQUEsVUFBQSx3QkFBQSxnQkFBQSxnQkFBQSxXQUFBLENBQUEsS0FBQSxNQUFBOzs7SUFHQSxTQUFBLFVBQUEsTUFBQTs7R0FFQSxJQUFBLFNBQUE7S0FDQSxTQUFBLEtBQUE7UUFDQSxTQUFBLEtBQUE7UUFDQSxPQUFBO1FBQ0EsS0FBQSxLQUFBLGVBQUEsVUFBQSxLQUFBLE9BQUE7OztNQUdBLElBQUEsS0FBQSxjQUFBLEtBQUEsV0FBQSxTQUFBLEdBQUE7SUFDQSxPQUFBLE1BQUEsS0FBQSxLQUFBLFdBQUEsR0FBQTs7O0dBR0EsT0FBQSxNQUFBOzs7RUFHQSxTQUFBLFdBQUEsT0FBQTs7R0FFQSxJQUFBLFNBQUE7S0FDQSxTQUFBLE1BQUE7UUFDQSxTQUFBLE1BQUE7UUFDQSxPQUFBO1FBQ0EsS0FBQSxNQUFBOzs7Ozs7R0FNQSxJQUFBLE1BQUEsZUFBQSxhQUFBO0lBQ0EsT0FBQSxNQUFBLEtBQUEsTUFBQTtJQUNBLE9BQUEsTUFBQTtVQUNBLElBQUEsTUFBQSxjQUFBLE1BQUEsV0FBQSxTQUFBLEdBQUE7SUFDQSxPQUFBLE1BQUEsS0FBQSxNQUFBLFdBQUEsR0FBQTs7O0dBR0EsT0FBQSxNQUFBOzs7RUFHQSxTQUFBLE1BQUEsUUFBQTs7Ozs7Ozs7Ozs7TUFXQSxJQUFBLElBQUEsR0FBQTtNQUNBLElBQUEsU0FBQSxRQUFBLFdBQUEsUUFBQSxRQUFBOzs7O0dBSUEsSUFBQSxRQUFBO1FBQ0EsSUFBQSxRQUFBLFNBQUE7TUFDQSxPQUFBLFdBQUEsUUFBQTs7O1FBR0EsT0FBQSxVQUFBLE9BQUEsV0FBQSxVQUFBLE1BQUEsT0FBQTtRQUNBLE9BQUEsVUFBQSxPQUFBLFdBQUEsVUFBQSxNQUFBLE9BQUE7UUFDQSxJQUFBLFdBQUE7VUFDQSxTQUFBLFNBQUEsUUFBQTtZQUNBLEVBQUEsUUFBQTs7VUFFQSxNQUFBLFNBQUEsS0FBQTtZQUNBLEVBQUEsT0FBQTs7OztRQUlBLEtBQUEsTUFBQTtRQUNBLEtBQUEsTUFBQTtRQUNBLE9BQUEsaUJBQUEsUUFBQSxTQUFBLFNBQUEsU0FBQTtVQUNBO0tBQ0EsRUFBQSxPQUFBOzs7TUFHQSxPQUFBLEVBQUE7Ozs7QUN0SEEsQ0FBQSxXQUFBO0NBQ0E7OztDQUVBO0VBQ0EsT0FBQSwyQkFBQTtFQUNBLFFBQUEsc0JBQUE7O0NBRUEsU0FBQSxtQkFBQSxJQUFBLFlBQUEsTUFBQTs7RUFFQSxJQUFBLGNBQUE7O0VBRUEsT0FBQTtHQUNBLFNBQUEsU0FBQSxRQUFBO1FBQ0EsSUFBQSxDQUFBLGVBQUE7VUFDQSxXQUFBLFdBQUE7OztJQUdBLE9BQUEsVUFBQSxHQUFBLEtBQUE7O0dBRUEsVUFBQSxTQUFBLFVBQUE7SUFDQSxJQUFBLEVBQUEsRUFBQSxjQUFBO0tBQ0EsV0FBQSxXQUFBOzs7SUFHQSxPQUFBLFlBQUEsR0FBQSxLQUFBOztHQUVBLGNBQUEsU0FBQSxTQUFBO0lBQ0EsSUFBQSxFQUFBLEVBQUEsY0FBQTtLQUNBLFdBQUEsV0FBQTs7O0lBR0EsT0FBQSxHQUFBLE9BQUE7O0dBRUEsZUFBQSxTQUFBLFVBQUE7SUFDQSxJQUFBLEVBQUEsRUFBQSxjQUFBO0tBQ0EsV0FBQSxXQUFBOzs7SUFHQSxPQUFBLEdBQUEsT0FBQTs7Ozs7O0FDdENBLENBQUEsWUFBQTtFQUNBOzs7O0FBRUE7RUFDQSxPQUFBLHlCQUFBLENBQUE7RUFDQSxTQUFBLFNBQUE7RUFDQSxtQkFBQTtHQUNBLE9BQUE7R0FDQSxPQUFBO0dBQ0EsV0FBQTtHQUNBLFVBQUE7O0VBRUEsYUFBQTtHQUNBLE9BQUE7R0FDQSxPQUFBO0dBQ0EsV0FBQTtHQUNBLFVBQUE7O0lBRUEsc0NBQUE7R0FDQSxPQUFBO0dBQ0EsT0FBQTtHQUNBLFdBQUE7R0FDQSxVQUFBOztFQUVBLDRCQUFBO0dBQ0EsT0FBQTtHQUNBLE9BQUE7R0FDQSxXQUFBO0dBQ0EsVUFBQTs7RUFFQSxjQUFBO0dBQ0EsT0FBQTtHQUNBLE9BQUE7R0FDQSxXQUFBO0dBQ0EsVUFBQTs7RUFFQSxpQ0FBQTtHQUNBLE9BQUE7R0FDQSxPQUFBO0dBQ0EsV0FBQTtHQUNBLFVBQUE7O0VBRUEscUVBQUE7R0FDQSxPQUFBO0dBQ0EsT0FBQTtHQUNBLFdBQUE7R0FDQSxVQUFBOzs7RUFHQSxPQUFBLG1CQUFBO0VBQ0EsT0FBQSxrQkFBQTtHQUNBLFNBQUEsWUFBQTs7RUFFQSxTQUFBLFdBQUE7SUFDQSxJQUFBLGdCQUFBO0lBQ0EsSUFBQSxRQUFBO0lBQ0EsSUFBQSxVQUFBO01BQ0EsYUFBQTs7SUFFQSxJQUFBLFdBQUE7TUFDQSxVQUFBO01BQ0EsYUFBQTtNQUNBLFlBQUE7OztJQUdBLEtBQUEsYUFBQSxTQUFBLFNBQUE7TUFDQSxRQUFBLE9BQUEsU0FBQTs7O0lBR0EsS0FBQSxZQUFBLFNBQUEsTUFBQSxPQUFBO01BQ0EsUUFBQSxRQUFBOzs7SUFHQSxLQUFBLGtEQUFBLFNBQUEsSUFBQSxNQUFBLFNBQUEsT0FBQSxNQUFBO01BQ0EsSUFBQSxNQUFBO01BQ0EsSUFBQSxVQUFBOzs7Ozs7TUFNQSxJQUFBLG1CQUFBLFNBQUEsR0FBQTs7Ozs7O1FBTUEsUUFBQSxFQUFBO1VBQ0EsS0FBQSxVQUFBO1lBQ0EsRUFBQSxVQUFBO1lBQ0E7VUFDQSxLQUFBLFVBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsVUFBQTtZQUNBLEVBQUEsVUFBQTtZQUNBO1VBQ0EsS0FBQSxVQUFBO1lBQ0EsRUFBQSxVQUFBO1lBQ0E7VUFDQSxLQUFBLFVBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsVUFBQTtZQUNBLEVBQUEsVUFBQTtZQUNBO1VBQ0EsS0FBQSxVQUFBO1lBQ0EsRUFBQSxVQUFBO1lBQ0E7VUFDQSxLQUFBLFVBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsVUFBQTtZQUNBLEVBQUEsVUFBQTtZQUNBO1VBQ0EsS0FBQSxVQUFBO1lBQ0EsRUFBQSxVQUFBO1lBQ0E7VUFDQSxLQUFBLFVBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsVUFBQTtZQUNBLEVBQUEsVUFBQTtZQUNBO1VBQ0E7WUFDQSxFQUFBLFVBQUE7WUFDQTs7UUFFQSxLQUFBLE1BQUEsWUFBQSxFQUFBOztRQUVBLE9BQUE7OztNQUdBLElBQUEsMkJBQUEsU0FBQSxHQUFBOzs7OztRQUtBLFFBQUEsRUFBQTtVQUNBLEtBQUEsa0JBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsa0JBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsa0JBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsa0JBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBLEtBQUEsa0JBQUE7WUFDQSxFQUFBLFVBQUE7WUFDQTtVQUNBO1lBQ0EsRUFBQSxVQUFBO1lBQ0E7O1FBRUEsS0FBQSxNQUFBLFlBQUEsRUFBQTs7UUFFQSxPQUFBOzs7TUFHQSxJQUFBLDJCQUFBLFdBQUE7Ozs7O1FBS0EsSUFBQSxDQUFBLE9BQUEsS0FBQSxPQUFBLFdBQUEsYUFBQSxVQUFBO1VBQ0EsSUFBQSxVQUFBLFFBQUEsU0FBQSxhQUFBO1VBQ0EsUUFBQSxJQUFBLDJCQUFBOztRQUVBLE9BQUE7OztNQUdBLElBQUEsY0FBQSxTQUFBLE1BQUE7UUFDQSxJQUFBLE1BQUEsS0FBQSxhQUFBOztRQUVBLElBQUEsQ0FBQSxPQUFBLE1BQUEsS0FBQTtVQUNBLE1BQUEsTUFBQSxLQUFBLE1BQUE7O1FBRUEsSUFBQSxPQUFBLEtBQUEsU0FBQTs7UUFFQSxJQUFBLENBQUEsTUFBQTtVQUNBLE9BQUEsSUFBQSxLQUFBO2VBQ0E7VUFDQSxPQUFBLEtBQUEsUUFBQTs7O1FBR0EsT0FBQSxPQUFBLE1BQUE7OztNQUdBLElBQUEsNkJBQUEsU0FBQSxTQUFBOzs7OztRQUtBLElBQUEsTUFBQTtRQUNBLE9BQUEsS0FBQSxTQUFBLFFBQUEsU0FBQSxJQUFBLE9BQUE7VUFDQSxJQUFBLFFBQUEsS0FBQSxRQUFBLFFBQUE7VUFDQSxJQUFBLFFBQUEsS0FBQSxNQUFBLFdBQUEsSUFBQSxnQkFBQSxRQUFBLEtBQUE7O1FBRUEsYUFBQSxXQUFBLFFBQUEsT0FBQTs7UUFFQSxPQUFBOzs7O01BSUEsSUFBQSxrQkFBQSxVQUFBLFVBQUE7UUFDQSxJQUFBLFlBQUE7SUFDQSxJQUFBLE9BQUEsWUFBQSxXQUFBO0tBQ0EsWUFBQSxRQUFBLEtBQUE7V0FDQTtTQUNBLFlBQUEsUUFBQSxLQUFBOztRQUVBLE9BQUEsWUFBQTs7O01BR0EsSUFBQSxjQUFBLFVBQUEsVUFBQTtRQUNBLE9BQUEsUUFBQSxjQUFBLE1BQUE7Ozs7TUFJQSxJQUFBLFVBQUEsU0FBQSxNQUFBO1FBQ0EsTUFBQSxLQUFBLFFBQUE7UUFDQSxhQUFBLFdBQUEsUUFBQSxPQUFBOzs7O01BSUEsSUFBQSxhQUFBLFNBQUEsSUFBQTtLQUNBLE9BQUEsTUFBQTtRQUNBLGFBQUEsV0FBQSxRQUFBLE9BQUE7Ozs7TUFJQSxJQUFBLGVBQUEsVUFBQSxNQUFBO1FBQ0EsSUFBQSxJQUFBLEdBQUE7UUFDQSxRQUFBO1VBQ0E7VUFDQSxTQUFBLE9BQUE7WUFDQSxFQUFBLFFBQUE7O1VBRUEsU0FBQSxPQUFBO1lBQ0EsS0FBQSxNQUFBO1lBQ0EsUUFBQSxJQUFBLGlCQUFBO1lBQ0EsRUFBQSxPQUFBOzs7UUFHQSxPQUFBLEVBQUE7OztNQUdBLElBQUEsZUFBQSxTQUFBLFVBQUE7Ozs7O1FBS0EsT0FBQSxDQUFBLENBQUEsSUFBQSwyQkFBQTs7O01BR0EsSUFBQSxnQkFBQSxTQUFBLFVBQUE7UUFDQSxPQUFBLENBQUEsQ0FBQSxjQUFBOzs7TUFHQSxJQUFBLGdCQUFBLFNBQUEsVUFBQTtRQUNBLElBQUEsSUFBQSxhQUFBLFdBQUE7VUFDQSxPQUFBLFNBQUE7ZUFDQSxJQUFBLElBQUEsY0FBQSxXQUFBO1VBQ0EsT0FBQSxTQUFBO2VBQ0E7VUFDQSxPQUFBLFNBQUE7Ozs7Ozs7OztNQVNBLFFBQUEsV0FBQTtNQUNBLFFBQUEsZUFBQTtNQUNBLFFBQUEsU0FBQTtNQUNBLFFBQUEsT0FBQSxJQUFBO01BQ0EsUUFBQSxPQUFBO01BQ0EsUUFBQSxpQkFBQTtNQUNBLFFBQUEsaUJBQUE7O01BRUEsT0FBQTs7Ozs7OztNQU9BLFNBQUEsZUFBQSxNQUFBO1FBQ0EsT0FBQSxDQUFBLEtBQUEsUUFBQSxTQUFBLE1BQUEsS0FBQSxNQUFBLFdBQUE7OztNQUdBLFNBQUEsZUFBQSxLQUFBLE1BQUE7UUFDQSxJQUFBLElBQUEsR0FBQTs7UUFFQSxRQUFBLFFBQUEsWUFBQSxLQUFBLEtBQUEsTUFBQTtVQUNBLE9BQUEsVUFBQSxHQUFBO1lBQ0EsRUFBQSxPQUFBO2FBQ0EsU0FBQSxZQUFBO1lBQ0EsRUFBQTs7O1FBR0EsT0FBQSxFQUFBO09BQ0E7O01BRUEsU0FBQSxLQUFBLE1BQUE7UUFDQSxJQUFBLElBQUEsR0FBQTtRQUNBLElBQUEsV0FBQTtVQUNBLFNBQUEsU0FBQSxPQUFBO1lBQ0EsZUFBQSxNQUFBLFNBQUEsS0FBQSxNQUFBO2NBQ0EsV0FBQTtnQkFDQSxFQUFBOztjQUVBLFNBQUEsR0FBQTtnQkFDQSxFQUFBLE9BQUE7Ozs7VUFJQSxNQUFBLFNBQUEsR0FBQTtZQUNBLEVBQUEsT0FBQTs7OztRQUlBLEtBQUEsV0FBQSxJQUFBLGdCQUFBLEtBQUE7UUFDQSxJQUFBLGFBQUEsS0FBQTtXQUNBLEtBQUEsU0FBQSxPQUFBO1lBQ0EsU0FBQSxRQUFBO2FBQ0EsU0FBQSxHQUFBO1lBQ0EsU0FBQSxLQUFBOzs7O1FBSUEsT0FBQSxFQUFBO09BQ0E7O01BRUEsU0FBQSxTQUFBLE1BQUE7UUFDQSxJQUFBLElBQUEsR0FBQTtRQUNBLElBQUEsS0FBQSxJQUFBO1FBQ0EsSUFBQSxNQUFBLFVBQUEsS0FBQTs7UUFFQSxLQUFBLFNBQUEsU0FBQTtRQUNBLEtBQUEsV0FBQSxJQUFBLGdCQUFBLEtBQUE7UUFDQSxjQUFBLEtBQUEsUUFBQTs7UUFFQSxHQUFBLGFBQUEsVUFBQSxVQUFBO1VBQ0EsRUFBQSxPQUFBOzs7UUFHQSxFQUFBLFFBQUEsUUFBQSxZQUFBO1VBQ0EsR0FBQTs7O1FBR0EsSUFBQSxjQUFBO1VBQ0EsU0FBQSxTQUFBLFdBQUE7WUFDQSxLQUFBLFNBQUEsU0FBQTtNQUNBLElBQUEsUUFBQTtNQUNBLE9BQUEsY0FBQSxLQUFBO1lBQ0EsRUFBQSxRQUFBOztVQUVBLE1BQUEsU0FBQSxPQUFBO1lBQ0EsS0FBQSxNQUFBO1lBQ0EsS0FBQSxTQUFBLFNBQUE7WUFDQSxRQUFBLElBQUEseUJBQUE7TUFDQSxPQUFBLGNBQUEsS0FBQTtNQUNBLEVBQUEsT0FBQTs7O1FBR0EsR0FBQSxTQUFBLEtBQUEsS0FBQSxVQUFBLFlBQUEsU0FBQSxZQUFBLE1BQUE7O1FBRUEsT0FBQSxFQUFBO09BQ0E7O01BRUEsU0FBQSxPQUFBLE1BQUE7UUFDQSxJQUFBLElBQUEsR0FBQTs7UUFFQSxLQUFBLFdBQUEsSUFBQSxnQkFBQSxLQUFBO1FBQ0EsSUFBQSxhQUFBLEtBQUE7V0FDQSxLQUFBLFNBQUEsT0FBQTtZQUNBLE1BQUE7Y0FDQSxVQUFBLFFBQUE7Z0JBQ0EsSUFBQSxXQUFBLEtBQUE7Z0JBQ0EsS0FBQSxTQUFBLFNBQUE7Z0JBQ0EsRUFBQSxRQUFBO2dCQUNBLFVBQUEsT0FBQTtnQkFDQSxFQUFBLE9BQUE7OzthQUdBLFNBQUEsT0FBQTtZQUNBLEtBQUEsU0FBQSxTQUFBO1lBQ0EsRUFBQSxPQUFBOzs7O1FBSUEsT0FBQSxFQUFBOzs7TUFHQSxTQUFBLGFBQUEsTUFBQTtRQUNBLEtBQUEsT0FBQSxLQUFBLFFBQUEsSUFBQSxZQUFBO1FBQ0EsS0FBQSxPQUFBLEtBQUEsUUFBQSxJQUFBLFlBQUEsS0FBQTtRQUNBLEtBQUEsU0FBQSxJQUFBLGNBQUEsS0FBQTs7Ozs7UUFLQSxJQUFBLENBQUEsT0FBQSxTQUFBO1VBQ0EsSUFBQSxXQUFBLElBQUEsZ0JBQUEsS0FBQTtVQUNBLElBQUEsSUFBQSxhQUFBO1lBQ0EsS0FBQSxXQUFBO1NBQ0E7O1FBRUEsT0FBQTtPQUNBOztHQUVBOztDQUVBLFNBQUEsZ0JBQUEsT0FBQTtFQUNBLE9BQUEsU0FBQSxNQUFBO0dBQ0EsT0FBQSxNQUFBLFFBQUEsTUFBQSxNQUFBLFFBQUE7Ozs7Q0FJQSxTQUFBLGVBQUEsT0FBQTtFQUNBLE9BQUEsU0FBQSxNQUFBO0dBQ0EsT0FBQSxNQUFBLFFBQUEsTUFBQSxNQUFBLFFBQUE7Ozs7QUM1YUEsQ0FBQSxXQUFBO0NBQ0E7OztDQUVBO0VBQ0EsT0FBQSwyQkFBQTtFQUNBLFFBQUEsY0FBQTs7Ozs7Ozs7RUFRQSxTQUFBLFdBQUEsSUFBQSxTQUFBOztJQUVBLElBQUEsVUFBQTs7SUFFQSxRQUFBLFFBQUE7SUFDQSxRQUFBLFVBQUE7SUFDQSxRQUFBLFFBQUE7O0lBRUEsT0FBQTs7SUFFQSxTQUFBLE9BQUEsU0FBQSxPQUFBLFlBQUE7TUFDQSxJQUFBLElBQUEsR0FBQTs7TUFFQSxJQUFBLENBQUEsUUFBQSxVQUFBLGNBQUE7UUFDQSxRQUFBLE1BQUE7UUFDQSxFQUFBO2FBQ0E7UUFDQSxVQUFBLGFBQUEsTUFBQSxTQUFBLFlBQUE7VUFDQSxFQUFBO1dBQ0EsT0FBQTs7O01BR0EsT0FBQSxFQUFBO0tBQ0E7O0lBRUEsU0FBQSxTQUFBLFNBQUEsT0FBQSxjQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7O01BRUEsSUFBQSxDQUFBLFFBQUEsVUFBQSxjQUFBO1FBQ0EsSUFBQSxRQUFBLFFBQUEsVUFBQTtVQUNBLEVBQUEsUUFBQTtlQUNBO1VBQ0EsRUFBQSxRQUFBOzthQUVBO1FBQ0EsVUFBQSxhQUFBLFFBQUEsU0FBQSxVQUFBLGFBQUE7VUFDQSxFQUFBLFFBQUE7V0FDQSxPQUFBOzs7TUFHQSxPQUFBLEVBQUE7S0FDQTs7SUFFQSxTQUFBLE9BQUEsU0FBQTtNQUNBLElBQUEsSUFBQSxHQUFBO0dBQ0EsSUFBQSxRQUFBLFFBQUEsV0FBQSxRQUFBLFFBQUE7O0dBRUEsSUFBQSxPQUFBO1FBQ0EsTUFBQSxlQUFBLFNBQUEsVUFBQSxVQUFBO1VBQ0EsRUFBQSxRQUFBO1dBQ0EsVUFBQSxPQUFBO1VBQ0EsRUFBQSxPQUFBOzthQUVBO1FBQ0EsTUFBQTs7O01BR0EsT0FBQSxFQUFBO0tBQ0E7OztBQ3ZFQSxDQUFBLFdBQUE7Q0FDQTs7Q0FFQTtFQUNBLE9BQUEsNEJBQUE7RUFDQSxRQUFBLGVBQUEsQ0FBQSxNQUFBLFdBQUEsbUJBQUEsZUFBQTs7Ozs7OztFQU9BLFNBQUEsWUFBQSxJQUFBLFNBQUEsV0FBQSxPQUFBOztJQUVBLElBQUEsVUFBQTs7SUFFQSxRQUFBLDJCQUFBOztJQUVBLE9BQUE7O0lBRUEsU0FBQSx5QkFBQSxTQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7UUFDQSxpQkFBQTtVQUNBLE9BQUE7VUFDQSxTQUFBO1VBQ0EsYUFBQTtVQUNBLFlBQUE7VUFDQSxVQUFBOzs7TUFHQSxpQkFBQSxRQUFBLE9BQUEsZ0JBQUE7O01BRUEsUUFBQSxRQUFBLFNBQUE7UUFDQSxVQUFBLGVBQUE7UUFDQSxVQUFBLGVBQUE7UUFDQSxVQUFBLE1BQUEsZUFBQTtRQUNBLElBQUEsS0FBQSxlQUFBLGNBQUE7UUFDQSxJQUFBLEtBQUEsZUFBQSxZQUFBO1FBQ0EsVUFBQSxTQUFBO1VBQ0EsRUFBQSxRQUFBO1dBQ0EsVUFBQSxPQUFBO1VBQ0EsRUFBQSxPQUFBOzs7O01BSUEsT0FBQSxFQUFBOzs7O0FDN0NBLENBQUEsV0FBQTtDQUNBOzs7Ozs7Q0FFQTtFQUNBLE9BQUEsNkJBQUE7RUFDQSxRQUFBLDBCQUFBO0VBQ0EsUUFBQSxtQkFBQTtHQUNBLFFBQUEsMkJBQUE7RUFDQSxRQUFBLGdCQUFBOzs7Ozs7Ozs7RUFTQSxTQUFBLHdCQUFBLElBQUEsU0FBQSxNQUFBOztJQUVBLElBQUEsVUFBQTs7SUFFQSxRQUFBLHFCQUFBO0lBQ0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxhQUFBO0lBQ0EsUUFBQSxZQUFBOztJQUVBLE9BQUE7O0lBRUEsU0FBQSxVQUFBLElBQUE7TUFDQSxJQUFBLElBQUEsR0FBQTs7TUFFQSxLQUFBLE1BQUEsa0JBQUE7O01BRUEsUUFBQSxVQUFBLFVBQUEsSUFBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxVQUFBLE9BQUE7UUFDQSxFQUFBLE9BQUE7OztNQUdBLE9BQUEsRUFBQTs7O0lBR0EsU0FBQSxtQkFBQSxJQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7O01BRUEsS0FBQSxNQUFBLDJCQUFBOztNQUVBLFFBQUEsVUFBQSxtQkFBQSxJQUFBLFVBQUEsVUFBQTtRQUNBLEVBQUEsUUFBQTtTQUNBLFVBQUEsT0FBQTtRQUNBLEVBQUEsT0FBQTs7O01BR0EsT0FBQSxFQUFBOzs7SUFHQSxTQUFBLFlBQUE7TUFDQSxJQUFBLElBQUEsR0FBQTs7TUFFQSxRQUFBLFVBQUEsVUFBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxZQUFBO1FBQ0EsRUFBQTs7O01BR0EsT0FBQSxFQUFBOzs7SUFHQSxTQUFBLFVBQUEsWUFBQTtNQUNBLElBQUEsSUFBQSxHQUFBOztNQUVBLEtBQUEsTUFBQSxpQkFBQTs7TUFFQSxRQUFBLFVBQUEsVUFBQSxZQUFBLFVBQUEsVUFBQTtRQUNBLEVBQUEsUUFBQTtTQUNBLFVBQUEsT0FBQTtRQUNBLEVBQUEsT0FBQTs7O01BR0EsT0FBQSxFQUFBOzs7SUFHQSxTQUFBLFdBQUEsVUFBQSxRQUFBLE9BQUEsT0FBQTtNQUNBLElBQUEsSUFBQSxHQUFBOztNQUVBLElBQUEsS0FBQSxDQUFBLFVBQUEsUUFBQSxPQUFBO01BQ0EsS0FBQSxNQUFBLGtCQUFBLEdBQUE7O01BRUEsUUFBQSxVQUFBLFdBQUEsVUFBQSxRQUFBLE9BQUEsT0FBQSxVQUFBLFVBQUE7UUFDQSxFQUFBLFFBQUE7U0FDQSxVQUFBLE9BQUE7UUFDQSxFQUFBLE9BQUE7OztNQUdBLE9BQUEsRUFBQTs7OztDQUlBLFNBQUEsdUJBQUEseUJBQUEsTUFBQTs7SUFFQSxJQUFBLFVBQUE7O0lBRUEsUUFBQSxPQUFBO0lBQ0EsUUFBQSxZQUFBLHdCQUFBO0lBQ0EsUUFBQSxZQUFBLHdCQUFBO0lBQ0EsUUFBQSxhQUFBLHdCQUFBO0lBQ0EsUUFBQSxxQkFBQSx3QkFBQTtJQUNBLFFBQUEsWUFBQSx3QkFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsS0FBQSxTQUFBO01BQ0Esd0JBQUEsbUJBQUE7Ozs7Q0FJQSxTQUFBLGdCQUFBLE1BQUEsSUFBQTs7SUFFQSxJQUFBLFVBQUE7O0lBRUEsUUFBQSxPQUFBO0lBQ0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxZQUFBO0lBQ0EsUUFBQSxhQUFBO0lBQ0EsUUFBQSxzQkFBQTtJQUNBLFFBQUEsWUFBQTs7SUFFQSxPQUFBOztJQUVBLFNBQUEsS0FBQSxTQUFBO01BQ0EsS0FBQSxNQUFBLGdDQUFBOzs7SUFHQSxTQUFBLFlBQUE7TUFDQSxLQUFBLE1BQUE7OztJQUdBLFNBQUEsVUFBQSxPQUFBO01BQ0EsS0FBQSxNQUFBLG9CQUFBOzs7SUFHQSxTQUFBLFdBQUEsVUFBQSxRQUFBLE9BQUEsT0FBQTtNQUNBLEtBQUEsTUFBQSxxQkFBQTs7O0lBR0EsU0FBQSxtQkFBQSxJQUFBO01BQ0EsSUFBQSxNQUFBLHFCQUFBO01BQ0EsSUFBQSxJQUFBLEdBQUE7O01BRUEsRUFBQSxRQUFBOztNQUVBLE9BQUEsRUFBQTs7O0lBR0EsU0FBQSxVQUFBLElBQUE7TUFDQSxLQUFBLE1BQUEsb0JBQUE7Ozs7Q0FJQSxTQUFBLGFBQUEsV0FBQSxTQUFBOztFQUVBLElBQUEsUUFBQSxTQUFBO0dBQ0EsT0FBQSxVQUFBLElBQUE7U0FDQTtJQUNBLE9BQUEsVUFBQSxJQUFBOzs7Ozs7QUNuS0EsQ0FBQSxZQUFBO0VBQ0E7O0VBRUEsUUFBQSxPQUFBLDJCQUFBO0dBQ0EsT0FBQSxXQUFBO0dBQ0EsT0FBQSxTQUFBO0dBQ0EsT0FBQSxhQUFBOztFQUVBLFNBQUEsVUFBQTtJQUNBLE9BQUEsVUFBQSxLQUFBO01BQ0EsT0FBQSxDQUFBLE9BQUEsS0FBQSxLQUFBOzs7O0VBSUEsU0FBQSxRQUFBO0lBQ0EsT0FBQSxVQUFBLE1BQUE7TUFDQSxPQUFBLEtBQUEsUUFBQSxrQkFBQTs7OztFQUlBLFNBQUEsWUFBQTtJQUNBLE9BQUEsVUFBQSxNQUFBO01BQ0EsT0FBQTtXQUNBLFFBQUE7V0FDQSxLQUFBO1dBQ0E7Ozs7Ozs7Ozs7QUN0QkEsQ0FBQSxZQUFBO0VBQ0E7O0VBRUEsUUFBQSxPQUFBLG1CQUFBOzs7SUFHQTs7SUFFQTtJQUNBO0lBQ0E7SUFDQTtJQUNBOzs7OztBQUtBIiwiZmlsZSI6Im5nLW1ldW1vYmktdXRpbHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhclxuXHQubW9kdWxlKCduZ01ldW1vYmkuVXRpbHMuc29jaWFsU2hhcmluZycsIFtdKVxuXHQuZmFjdG9yeSgnbWV1U29jaWFsU2hhcmluZycsIFsnJHEnLCAnJHdpbmRvdycsICdzdHJpcHRhZ3NGaWx0ZXInLCAnYnIybmxGaWx0ZXInLCAnJGxvZycsIG1ldVNvY2lhbFNoYXJpbmddKTtcbiAgXG4gIC8qXG4gICAgY29yZG92YSBwbHVnaW4gYWRkIGh0dHBzOi8vZ2l0aHViLmNvbS9FZGR5VmVyYnJ1Z2dlbi9Tb2NpYWxTaGFyaW5nLVBob25lR2FwLVBsdWdpblxuICAqL1xuICBcbiAgZnVuY3Rpb24gbWV1U29jaWFsU2hhcmluZygkcSwgJHdpbmRvdywgc3RyaXB0YWdzLCBicjJubCwgJGxvZykge1xuICAgIFxuICAgIHZhciBzZXJ2aWNlID0ge307XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICBwb3N0Zml4OiAnJ1xuICAgIH07XG4gICAgXG4gICAgc2VydmljZS5zaGFyZUl0ZW0gPSBzaGFyZUl0ZW07XG4gICAgc2VydmljZS5zaGFyZU1lZGlhID0gc2hhcmVNZWRpYTtcbiAgICBzZXJ2aWNlLnNldE9wdGlvbiA9IHNldE9wdGlvbjtcbiAgICBzZXJ2aWNlLnNldE9wdGlvbnMgPSBzZXRPcHRpb25zO1xuICAgIHNlcnZpY2Uuc2hhcmUgPSBzaGFyZTtcbiAgICBzZXJ2aWNlLnNoYXJlVmlhV2hhdHNBcHBUb1JlY2VpdmVyID0gc2hhcmVWaWFXaGF0c0FwcFRvUmVjZWl2ZXI7XG4gICAgXG4gICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICBmdW5jdGlvbiBzZXRPcHRpb25zKG9wdGlvbnMpIHtcbiAgICAgIGFuZ3VsYXIuZXh0ZW5kKG9wdGlvbnMsIG9wdGlvbnMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldE9wdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgICAgb3B0aW9uc1tuYW1lXSA9IHZhbHVlO1xuICAgIH1cblxuXHRcdGZ1bmN0aW9uIHNoYXJlVmlhV2hhdHNBcHBUb1JlY2VpdmVyKHJlY2VpdmVyKSB7XG4gICAgICB2YXIgc29jaWFsID0gJHdpbmRvdy5wbHVnaW5zICYmICR3aW5kb3cucGx1Z2lucy5zb2NpYWxzaGFyaW5nO1xuXHRcdCAgXG4gICAgICBzb2NpYWwuc2hhcmVWaWFXaGF0c0FwcFRvUmVjZWl2ZXIocmVjZWl2ZXIsICdNZXNzYWdlIHZpYSBXaGF0c0FwcCcsIG51bGwgLyogaW1nICovLCBudWxsIC8qIHVybCAqLywgZnVuY3Rpb24oKSB7JGxvZy5kZWJ1Zygnc2hhcmUgb2snKTt9KTtcblx0XHR9XG4gICAgXG4gICAgZnVuY3Rpb24gc2hhcmVJdGVtKGl0ZW0pIHtcblx0XHRcdFxuXHRcdFx0dmFyIHBhcmFtcyA9IHtcblx0XHRcdCAgbWVzc2FnZTogaXRlbS5kZXNjcmlwdGlvbixcbiAgICAgICAgc3ViamVjdDogaXRlbS50aXRsZSxcbiAgICAgICAgZmlsZXM6IFtdLFxuICAgICAgICB1cmw6IGl0ZW0uaGFzT3duUHJvcGVydHkoJ2xpbmsnKSA/IGl0ZW0ubGluayA6IG51bGxcblx0XHRcdH07XG5cbiAgICAgIGlmIChpdGVtLnRodW1ibmFpbHMgJiYgaXRlbS50aHVtYm5haWxzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0cGFyYW1zLmZpbGVzLnB1c2goaXRlbS50aHVtYm5haWxzWzBdLnVybCk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBzaGFyZShwYXJhbXMpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHNoYXJlTWVkaWEobWVkaWEpIHtcblxuXHRcdFx0dmFyIHBhcmFtcyA9IHtcblx0XHRcdCAgbWVzc2FnZTogbWVkaWEudGl0bGUsXG4gICAgICAgIHN1YmplY3Q6IG1lZGlhLnRpdGxlLFxuICAgICAgICBmaWxlczogW10sXG4gICAgICAgIHVybDogbWVkaWEudXJsXG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHQvLyBJZiBtZWRpYSBpcyBzYXZlZCBsb2NhbGx5IChtZWRpYS5wYXRoKSB0aGVuIHNoYXJlIGl0XG5cdFx0XHQvLyBFbHNlIHNoYXJlIGl0cyBsaW5rIChtZWRpYS51cmwpXG5cdFx0XHQvLyBDb3VsZG4ndCBzaGFyZSB0b2dldGhlciBsb2NhbCBwZGYgYW5kIGxpbmtcblx0XHRcdGlmIChtZWRpYS5oYXNPd25Qcm9wZXJ0eSgnZnVsbFBhdGgnKSkge1xuXHRcdFx0XHRwYXJhbXMuZmlsZXMucHVzaChtZWRpYS5mdWxsUGF0aCk7XG5cdFx0XHRcdHBhcmFtcy51cmwgPSBudWxsO1xuXHRcdFx0fSBlbHNlIGlmIChtZWRpYS50aHVtYm5haWxzICYmIG1lZGlhLnRodW1ibmFpbHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRwYXJhbXMuZmlsZXMucHVzaChtZWRpYS50aHVtYm5haWxzWzBdLnVybCk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHJldHVybiBzaGFyZShwYXJhbXMpO1xuXHRcdH1cblx0XHRcblx0XHRmdW5jdGlvbiBzaGFyZShwYXJhbXMpIHtcbiAgICAvKlxuICAgICAgdGhpcyBpcyB0aGUgY29tcGxldGUgbGlzdCBvZiBjdXJyZW50bHkgc3VwcG9ydGVkIHBhcmFtcyB5b3UgY2FuIHBhc3MgdG8gdGhlIHBsdWdpbiAoYWxsIG9wdGlvbmFsKVxuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIG1lc3NhZ2U6ICdzaGFyZSB0aGlzJywgLy8gbm90IHN1cHBvcnRlZCBvbiBzb21lIGFwcHMgKEZhY2Vib29rLCBJbnN0YWdyYW0pXG4gICAgICAgIHN1YmplY3Q6ICd0aGUgc3ViamVjdCcsIC8vIGZpLiBmb3IgZW1haWxcbiAgICAgICAgZmlsZXM6IFsnJywgJyddLCAvLyBhbiBhcnJheSBvZiBmaWxlbmFtZXMgZWl0aGVyIGxvY2FsbHkgb3IgcmVtb3RlbHlcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cud2Vic2l0ZS5jb20vZm9vLyNiYXI/YT1iJyxcbiAgICAgICAgY2hvb3NlclRpdGxlOiAnUGljayBhbiBhcHAnIC8vIEFuZHJvaWQgb25seSwgeW91IGNhbiBvdmVycmlkZSB0aGUgZGVmYXVsdCBzaGFyZSBzaGVldCB0aXRsZVxuICAgICAgfVxuICAgICovXG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XHRcdFx0XG4gICAgICB2YXIgc29jaWFsID0gJHdpbmRvdy5wbHVnaW5zICYmICR3aW5kb3cucGx1Z2lucy5zb2NpYWxzaGFyaW5nO1xuICAgICAgXG4gICAgICAvLyBJZiBwYXJhbXMuZGVzY3JpcHRpb24gaXMgbnVsbFxuICAgIFxuXHRcdFx0aWYgKHNvY2lhbCkge1xuICAgICAgICBpZiAob3B0aW9ucy5wb3N0Zml4KSB7XG4gIFx0XHRcdFx0cGFyYW1zLnN1YmplY3QgKz0gb3B0aW9ucy5wb3N0Zml4O1xuICAgICAgICB9XG4gICAgICBcbiAgICAgICAgcGFyYW1zLm1lc3NhZ2UgPSBwYXJhbXMubWVzc2FnZSAmJiBzdHJpcHRhZ3MoYnIybmwocGFyYW1zLm1lc3NhZ2UpKTtcbiAgICAgICAgcGFyYW1zLnN1YmplY3QgPSBwYXJhbXMuc3ViamVjdCAmJiBzdHJpcHRhZ3MoYnIybmwocGFyYW1zLnN1YmplY3QpKTtcbiAgICAgICAgdmFyIGNiX3NoYXJlID0ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgZC5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmYWlsOiBmdW5jdGlvbihtc2cpIHtcbiAgICAgICAgICAgIGQucmVqZWN0KG1zZyk7XG4gICAgICAgICAgfSAgXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAkbG9nLmRlYnVnKCdzaGFyZVdpdGhPcHRpb25zJyk7XG4gICAgICAgICRsb2cuZGVidWcocGFyYW1zKTtcbiAgICAgICAgc29jaWFsLnNoYXJlV2l0aE9wdGlvbnMocGFyYW1zLCBjYl9zaGFyZS5zdWNjZXNzLCBjYl9zaGFyZS5mYWlsKTsgXG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0ICBkLnJlamVjdCgnUGx1Z2luIHNvY2lhbHNoYXJpbmcgbWlzc2luZycpO1xuXHRcdFx0fVxuICAgICAgXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuXHRcdH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyXG5cdC5tb2R1bGUoJ25nTWV1bW9iaS5VdGlscy5sb2FkaW5nJywgW10pXG5cdC5mYWN0b3J5KCdsb2FkaW5nSW50ZXJjZXB0b3InLCBsb2FkaW5nSW50ZXJjZXB0b3IpO1xuXHRcblx0ZnVuY3Rpb24gbG9hZGluZ0ludGVyY2VwdG9yKCRxLCAkcm9vdFNjb3BlLCAkbG9nKSB7XG5cdFx0XG5cdFx0dmFyIG51bUxvYWRpbmdzID0gMDtcblx0XHRcblx0XHRyZXR1cm4ge1xuXHRcdFx0cmVxdWVzdDogZnVuY3Rpb24oY29uZmlnKSB7XG4gICAgICAgIGlmICghbnVtTG9hZGluZ3MrKykge1xuICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZGluZzpzdGFydCcpO1xuICAgICAgICB9XG5cblx0XHRcdFx0cmV0dXJuIGNvbmZpZyB8fCAkcS53aGVuKGNvbmZpZyk7XG5cdFx0XHR9LFxuXHRcdFx0cmVzcG9uc2U6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cdFx0XHRcdGlmICghKC0tbnVtTG9hZGluZ3MpKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2FkaW5nOnN0b3AnKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcblx0XHRcdH0sXG5cdFx0XHRyZXF1ZXN0RXJyb3I6IGZ1bmN0aW9uKHJlcXVlc3QpIHtcblx0XHRcdFx0aWYgKCEoLS1udW1Mb2FkaW5ncykpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2xvYWRpbmc6c3RvcCcpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuICRxLnJlamVjdChyZXF1ZXN0KTtcblx0XHRcdH0sXG5cdFx0XHRyZXNwb25zZUVycm9yOiBmdW5jdGlvbihyZXNwb25zZSkge1xuXHRcdFx0XHRpZiAoISgtLW51bUxvYWRpbmdzKSkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnbG9hZGluZzpzdG9wJyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xuXHRcdFx0fVxuXHRcdH07XG5cdH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAndXNlIHN0cmljdCc7XG4gIFxuYW5ndWxhclxuXHQubW9kdWxlKCduZ01ldW1vYmkuVXRpbHMuZmlsZXMnLCBbJ3NsdWdpZmllciddKVxuXHQuY29uc3RhbnQoJ01JTUVTJywge1xuXHRcdCdhcHBsaWNhdGlvbi9wZGYnOiB7XG5cdFx0XHRjbGFzczogJ2ZhLWZpbGUtcGRmLW8nLFxuXHRcdFx0bGFiZWw6ICdWaWV3Jyxcblx0XHRcdGV4dGVuc2lvbjogJ3BkZicsXG5cdFx0XHRkb3dubG9hZDogdHJ1ZVxuXHRcdH0sXG5cdFx0J3RleHQvaHRtbCc6IHtcblx0XHRcdGNsYXNzOiAnZmEtcnNzJyxcblx0XHRcdGxhYmVsOiAnT3BlbicsXG5cdFx0XHRleHRlbnNpb246ICdodG1sJyxcblx0XHRcdGRvd25sb2FkOiBmYWxzZVxuXHRcdH0sXG4gICAgJ2FwcGxpY2F0aW9uL3ZuZC55b3V0dWJlLnZpZGVvK2h0bWwnOiB7XG5cdFx0XHRjbGFzczogJ2ZhLXlvdXR1YmUtcGxheScsXG5cdFx0XHRsYWJlbDogJ1BsYXknLFxuXHRcdFx0ZXh0ZW5zaW9uOiAnaHRtbCcsXG5cdFx0XHRkb3dubG9hZDogZmFsc2VcbiAgICB9LFxuXHRcdCdhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwnOiB7XG5cdFx0XHRjbGFzczogJ2ZhLWZpbGUtZXhjZWwtbycsXG5cdFx0XHRsYWJlbDogJ1ZpZXcnLFxuXHRcdFx0ZXh0ZW5zaW9uOiAneGxzJyxcblx0XHRcdGRvd25sb2FkOiB0cnVlXG5cdFx0fSxcblx0XHQnYXVkaW8vbXBlZyc6IHtcblx0XHRcdGNsYXNzOiAnZmEtZmlsZS1hdWRpby1vJyxcblx0XHRcdGxhYmVsOiAnUGxheScsXG5cdFx0XHRleHRlbnNpb246ICdtcDMnLFxuXHRcdFx0ZG93bmxvYWQ6IHRydWVcblx0XHR9LFxuXHRcdCdhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCc6IHtcblx0XHRcdGNsYXNzOiAnZmEtZmlsZS1wb3dlcnBvaW50LW8nLFxuXHRcdFx0bGFiZWw6ICdWaWV3Jyxcblx0XHRcdGV4dGVuc2lvbjogJ3BwdCcsXG5cdFx0XHRkb3dubG9hZDogdHJ1ZSxcblx0XHR9LFxuXHRcdCdhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQuc3ByZWFkc2hlZXRtbC5zaGVldCc6IHtcblx0XHRcdGNsYXNzOiAnZmEtZmlsZS1leGNlbC1vJyxcblx0XHRcdGxhYmVsOiAnVmlldycsXG5cdFx0XHRleHRlbnNpb246ICd4bHMnLFxuXHRcdFx0ZG93bmxvYWQ6IHRydWVcblx0XHR9XG5cdH0pXG5cdC5maWx0ZXIoJ21lZGlhQ2xpY2tMYWJlbCcsIG1lZGlhQ2xpY2tMYWJlbClcblx0LmZpbHRlcignbWVkaWFJY29uQ2xhc3MnLCBtZWRpYUljb25DbGFzcykgXG4gIC5wcm92aWRlcignbWV1RmlsZXMnLCBtZXVGaWxlcyk7IFxuICAgICAgICBcbiAgZnVuY3Rpb24gbWV1RmlsZXMoKSB7XG4gICAgdmFyIGZpbGVUcmFuc2ZlcnMgPSB7fTtcbiAgICB2YXIgZmlsZXMgPSB7fTtcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgIGxvY2FsRm9sZGVyOiAnRG93bmxvYWRzJ1xuICAgIH07XG4gICAgdmFyIHN0YXR1c2VzID0ge1xuICAgICAgZG93bmxvYWQ6ICdkb3dubG9hZCcsXG4gICAgICBkb3dubG9hZGluZzogJ2Rvd25sb2FkaW5nJyxcbiAgICAgIGRvd25sb2FkZWQ6ICdkb3dubG9hZGVkJ1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5zZXRPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgYW5ndWxhci5leHRlbmQob3B0aW9ucywgb3B0aW9ucyk7XG4gICAgfTtcblxuICAgIHRoaXMuc2V0T3B0aW9uID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICAgIG9wdGlvbnNbbmFtZV0gPSB2YWx1ZTtcbiAgICB9O1xuXG4gICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24oJHEsICRsb2csICR3aW5kb3csIE1JTUVTLCBTbHVnKSB7XG4gICAgICB2YXIgYXBpID0ge307XG4gICAgICB2YXIgc2VydmljZSA9IHt9O1xuICAgICAgXG4gICAgICAvKipcbiAgICAgICAqICBBcGkgbWV0aG9kcywgYXZhaWxhYmxlIG9ubHkgb24gdGhlIGluc2lkZSB0aGUgc2VydmljZVxuICAgICAgICovXG5cbiAgICAgIGFwaS5maWxlRXJyb3JIYW5kbGVyID0gZnVuY3Rpb24oZSkge1xuICAgICAgLypcbiAgICAgICAgTGlzdCBvZiBFcnJvcnMgY29yZG92YS1wbHVnaW4tZmlsZVxuICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vYXBhY2hlL2NvcmRvdmEtcGx1Z2luLWZpbGUjbGlzdC1vZi1lcnJvci1jb2Rlcy1hbmQtbWVhbmluZ3NcbiAgICAgICAgRm9yIHRoZSBtZWFuaW5nIEkgcmVjb21tZW5kIHRvIHJlYWQgaHR0cHM6Ly93aWNnLmdpdGh1Yi5pby9lbnRyaWVzLWFwaS8jY29tbW9uLXR5cGVzXG4gICAgICAqL1xuICAgICAgICBzd2l0Y2ggKGUuY29kZSkge1xuICAgICAgICAgIGNhc2UgRmlsZUVycm9yLk5PVF9GT1VORF9FUlI6XG4gICAgICAgICAgICBlLm1lc3NhZ2UgPSAnUmVxdWVzdGVkIGZpbGUgY291bGQgbm90IGJlIGZvdW5kJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgRmlsZUVycm9yLlNFQ1VSSVRZX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdTRUNVUklUWV9FUlInO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBGaWxlRXJyb3IuQUJPUlRfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ0FCT1JUX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVFcnJvci5OT1RfUkVBREFCTEVfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ05PVF9SRUFEQUJMRV9FUlInO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBGaWxlRXJyb3IuRU5DT0RJTkdfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ01hbGZvcm1lZCBVUkknO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBGaWxlRXJyb3IuTk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ05PX01PRElGSUNBVElPTl9BTExPV0VEX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVFcnJvci5JTlZBTElEX1NUQVRFX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdJTlZBTElEX1NUQVRFX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVFcnJvci5TWU5UQVhfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ1NZTlRBWF9FUlInO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBGaWxlRXJyb3IuSU5WQUxJRF9NT0RJRklDQVRJT05fRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ0lOVkFMSURfTU9ESUZJQ0FUSU9OX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVFcnJvci5RVU9UQV9FWENFRURFRF9FUlI6XG4gICAgICAgICAgICBlLm1lc3NhZ2UgPSAnUVVPVEFfRVhDRUVERURfRVJSJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgRmlsZUVycm9yLlRZUEVfTUlTTUFUQ0hfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ1RZUEVfTUlTTUFUQ0hfRVJSJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgRmlsZUVycm9yLlBBVEhfRVhJU1RTX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdQQVRIX0VYSVNUU19FUlInO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdVbmtub3duIEVycm9yJztcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgICRsb2cuZGVidWcoJ0Vycm9yOiAnICsgZS5tZXNzYWdlKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBlO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgYXBpLmZpbGVUcmFuc2ZlckVycm9ySGFuZGxlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8qXG4gICAgICAgIEEgRmlsZVRyYW5zZmVyRXJyb3Igb2JqZWN0IGlzIHBhc3NlZCB0byBhbiBlcnJvciBjYWxsYmFjayB3aGVuIGFuIGVycm9yIG9jY3Vycy5cbiAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL2FwYWNoZS9jb3Jkb3ZhLXBsdWdpbi1maWxlLXRyYW5zZmVyI2ZpbGV0cmFuc2ZlcmVycm9yXG4gICAgICAqL1xuICAgICAgICBzd2l0Y2ggKGUuY29kZSkge1xuICAgICAgICAgIGNhc2UgRmlsZVRyYW5zZmVyRXJyb3IuRklMRV9OT1RfRk9VTkRfRVJSOlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ0ZJTEVfTk9UX0ZPVU5EX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVUcmFuc2ZlckVycm9yLklOVkFMSURfVVJMX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdJTlZBTElEX1VSTF9FUlInO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSBGaWxlVHJhbnNmZXJFcnJvci5DT05ORUNUSU9OX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdDT05ORUNUSU9OX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVUcmFuc2ZlckVycm9yLkFCT1JUX0VSUjpcbiAgICAgICAgICAgIGUubWVzc2FnZSA9ICdPcGVyYXRpb24gYWJvcnRlZCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlIEZpbGVUcmFuc2ZlckVycm9yLk5PVF9NT0RJRklFRF9FUlI6XG4gICAgICAgICAgICBlLm1lc3NhZ2UgPSAnTk9UX01PRElGSUVEX0VSUic7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgZS5tZXNzYWdlID0gJ1Vua25vd24gRXJyb3InO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgJGxvZy5kZWJ1ZygnRXJyb3I6ICcgKyBlLm1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgICB9O1xuXG4gICAgICBhcGkuZ2V0RmlsZXNGcm9tTG9jYWxTdG9yYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAgQ2hlY2sgaWYgZmlsZXMgaXMgYWxyZWFkeSBsb2FkZWQgKGlmIG5vdCBpcyBlbXB0eSlcbiAgICAgICAgVE9ETzogaXMgbG9hZGluZyBsb2NhbFN0b3JhZ2VbJ2ZpbGVzXSBmb3IgZWFjaCBtZWRpYSwgc2hvdWxkIGJlIG9wdGltaXplZCB0byBvbmx5IGxvYWQgb25jZSBmb3IgYWxsXG4gICAgICAgICovXG4gICAgICAgIGlmICghT2JqZWN0LmtleXMoZmlsZXMpLmxlbmd0aCAgJiYgbG9jYWxTdG9yYWdlWydmaWxlcyddKSB7IFxuICAgICAgICAgIHZhciBlbnRyaWVzID0gYW5ndWxhci5mcm9tSnNvbihsb2NhbFN0b3JhZ2VbJ2ZpbGVzJ10pO1xuICAgICAgICAgIGZpbGVzID0gYXBpLmNoZWNrUmVwb3NpdG9yeUNvbnNpc3RlbmN5KGVudHJpZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlcztcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGFwaS5nZXRGaWxlTmFtZSA9IGZ1bmN0aW9uKGZpbGUpIHtcbiAgICAgICAgdmFyIGV4dCA9IGZpbGUuZXh0ZW5zaW9uIHx8ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFleHQgJiYgTUlNRVNbZmlsZS50eXBlXSlcbiAgICAgICAgICBleHQgPSBNSU1FU1tmaWxlLnR5cGVdLmV4dGVuc2lvbjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgdmFyIG5hbWUgPSBmaWxlLnRpdGxlIHx8ICcnO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgbmFtZSA9IG1kNShmaWxlLnVybCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmFtZSA9IFNsdWcuc2x1Z2lmeShuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgcmV0dXJuIG5hbWUgKyAnLicgKyBleHQ7XG4gICAgICB9O1xuICAgICAgXG4gICAgICBhcGkuY2hlY2tSZXBvc2l0b3J5Q29uc2lzdGVuY3kgPSBmdW5jdGlvbihlbnRyaWVzKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAgaWQgbXVzdCBiZSBlcXVhbHMgdG8gZmlsZS5wYXRoXG4gICAgICAgICAgYW5kIGZ1bGxQYXRoIGNhbiBiZSB1cGRhdGVkIGlmIEFwcCBpcyB1cGRhdGVkIChpT1MpXG4gICAgICAgICovXG4gICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXMoZW50cmllcykuZm9yRWFjaChmdW5jdGlvbihrZXksaW5kZXgpIHtcbiAgICAgICAgICBvYmpbZW50cmllc1trZXldLnBhdGhdID0gZW50cmllc1trZXldO1xuICAgICAgICAgIG9ialtlbnRyaWVzW2tleV0ucGF0aF0uZnVsbFBhdGggPSBhcGkuZ2V0RmlsZUZ1bGxQYXRoKGVudHJpZXNba2V5XS5wYXRoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZVsnZmlsZXMnXSA9IGFuZ3VsYXIudG9Kc29uKG9iaik7XG5cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFJldHVybnMgdGhlIGZ1bGwgYWJzb2x1dGUgcGF0aCBmcm9tIHRoZSByb290IHRvIHRoZSBGaWxlRW50cnlcbiAgICAgIGFwaS5nZXRGaWxlRnVsbFBhdGggPSBmdW5jdGlvbiAoZmlsZVBhdGgpIHtcbiAgICAgICAgdmFyIGRpcmVjdG9yeSA9IG51bGw7XG5cdFx0XHRcdGlmIChkZXZpY2UucGxhdGZvcm0gPT0gJ0FuZHJvaWQnKSB7XG5cdFx0XHRcdFx0ZGlyZWN0b3J5ID0gY29yZG92YS5maWxlLmV4dGVybmFsRGF0YURpcmVjdG9yeTtcblx0XHRcdFx0fSBlbHNlIHtcblx0ICAgICAgICBkaXJlY3RvcnkgPSBjb3Jkb3ZhLmZpbGUuZGF0YURpcmVjdG9yeTtcblx0XHRcdFx0fVxuICAgICAgICByZXR1cm4gZGlyZWN0b3J5ICsgZmlsZVBhdGg7XG4gICAgICB9O1xuICAgICAgXG4gICAgICBhcGkuZ2V0RmlsZVBhdGggPSBmdW5jdGlvbiAoZmlsZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMubG9jYWxGb2xkZXIgKyAnLycgKyBmaWxlTmFtZTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vYWRkIGZpbGUgdG8gbG9jYWxzdG9yYWdlXG4gICAgICBhcGkuYWRkRmlsZSA9IGZ1bmN0aW9uKGZpbGUpIHtcbiAgICAgICAgZmlsZXNbZmlsZS5wYXRoXSA9IGZpbGU7XG4gICAgICAgIGxvY2FsU3RvcmFnZVsnZmlsZXMnXSA9IGFuZ3VsYXIudG9Kc29uKGZpbGVzKTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vcmVtb3ZlIGZpbGUgZnJvbSBsb2NhbHN0b3JhZ2VcbiAgICAgIGFwaS5yZW1vdmVGaWxlID0gZnVuY3Rpb24oaWQpIHtcbiAgXHRcdFx0ZGVsZXRlIGZpbGVzW2lkXTtcbiAgICAgICAgbG9jYWxTdG9yYWdlWydmaWxlcyddID0gYW5ndWxhci50b0pzb24oZmlsZXMpO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy9nZXQgZmlsZXMgaGFuZGxlclxuICAgICAgYXBpLmdldEZpbGVFbnRyeSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBxID0gJHEuZGVmZXIoKTtcbiAgICAgICAgJHdpbmRvdy5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJMKFxuICAgICAgICAgIHBhdGgsIFxuICAgICAgICAgIGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBxLnJlc29sdmUoZW50cnkpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICRsb2cuZGVidWcoZXJyb3IpO1xuICAgICAgICAgICAgZXJyb3IgPSBhcGkuZmlsZUVycm9ySGFuZGxlcihlcnJvcik7XG4gICAgICAgICAgICBxLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gcS5wcm9taXNlO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgYXBpLmlzRG93bmxvYWRlZCA9IGZ1bmN0aW9uKGZpbGVQYXRoKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAgVE9ETzogSWYgc3RhdHVzIGlzIGRvd25sb2FkZWQgYnV0IGxvY2FsIGZpbGUgaXMgbWlzc2luZyB0aGVuIHJldHVybiBGQUxTRVxuICAgICAgICAgIEtlZXAgcmVjb3JkIG9uIGxvY2Fsc3RvcmFnZSB0byBhcHBlYXJzIGFzIGZpbGUgYWxyZWFkeSBkb3dubG9hZGVkLCB1c2VyIGNhbiByZS1kb3dubG9hZCBpZiBuZWVkZWRcbiAgICAgICAgKi9cbiAgICAgICAgcmV0dXJuICEhYXBpLmdldEZpbGVzRnJvbUxvY2FsU3RvcmFnZSgpW2ZpbGVQYXRoXTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGFwaS5pc0Rvd25sb2FkaW5nID0gZnVuY3Rpb24oZmlsZVBhdGgpIHtcbiAgICAgICAgcmV0dXJuICEhZmlsZVRyYW5zZmVyc1tmaWxlUGF0aF07ICAgICBcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGFwaS5nZXRGaWxlU3RhdHVzID0gZnVuY3Rpb24oZmlsZVBhdGgpIHtcbiAgICAgICAgaWYgKGFwaS5pc0Rvd25sb2FkZWQoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXR1c2VzLmRvd25sb2FkZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAoYXBpLmlzRG93bmxvYWRpbmcoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXR1c2VzLmRvd25sb2FkaW5nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBzdGF0dXNlcy5kb3dubG9hZDsgXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgXG4gICAgICAvKipcbiAgICAgICAqIFNlcnZpY2UgbWV0aG9kcywgdGhhdCBhcmUgcHVibGljIGFuZCBhdmFpbGFibGUgZm9yIGFueSByZXNvdXJjZVxuICAgICAgICovXG4gICAgICAvLyBGaWxlIGF2YWlsYWJsZSBzdGF0dXNlcywgYmVzdCBmb3IgZGVidWcgYW5kIG1haXRhaW4gdGhhbiBqdXN0IHN0cmluZy5cbiAgICAgIFxuICAgICAgc2VydmljZS5kb3dubG9hZCA9IGRvd25sb2FkO1xuICAgICAgc2VydmljZS5kZWNvcmF0ZUZpbGUgPSBkZWNvcmF0ZUZpbGU7XG4gICAgICBzZXJ2aWNlLnJlbW92ZSA9IHJlbW92ZTtcbiAgICAgIHNlcnZpY2UubGlzdCA9IGFwaS5nZXRGaWxlc0Zyb21Mb2NhbFN0b3JhZ2U7XG4gICAgICBzZXJ2aWNlLm9wZW4gPSBvcGVuO1xuICAgICAgc2VydmljZS5pc0Rvd25sb2FkYWJsZSA9IGlzRG93bmxvYWRhYmxlO1xuICAgICAgc2VydmljZS5vcGVuRmlsZU9wZW5lciA9IG9wZW5GaWxlT3BlbmVyO1xuICAgICAgXG4gICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgIFxuICAgICAgLypcbiAgICAgICAgSW5zdGFsbDogY29yZG92YSBwbHVnaW4gYWRkIGNvcmRvdmEtcGx1Z2luLWZpbGUtb3BlbmVyMlxuICAgICAgICBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9jb3Jkb3ZhLXBsdWdpbi1maWxlLW9wZW5lcjJcbiAgICAgICovXG4gICAgICBcbiAgICAgIGZ1bmN0aW9uIGlzRG93bmxvYWRhYmxlKGZpbGUpIHtcbiAgICAgICAgcmV0dXJuIChmaWxlLnR5cGUgaW4gTUlNRVMpID8gTUlNRVNbZmlsZS50eXBlXS5kb3dubG9hZCA6IHRydWU7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGZ1bmN0aW9uIG9wZW5GaWxlT3BlbmVyKHVyaSwgdHlwZSkge1xuICAgICAgICB2YXIgcSA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgY29yZG92YS5wbHVnaW5zLmZpbGVPcGVuZXIyLm9wZW4odXJpLCB0eXBlLCB7XG4gICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBxLnJlamVjdChlKTtcbiAgICAgICAgICB9LCBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBxLnJlc29sdmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcS5wcm9taXNlO1xuICAgICAgfTtcbiAgICAgIFxuICAgICAgZnVuY3Rpb24gb3BlbihmaWxlKSB7XG4gICAgICAgIHZhciBxID0gJHEuZGVmZXIoKTtcbiAgICAgICAgdmFyIGNiX2VudHJ5ID0ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBvcGVuRmlsZU9wZW5lcihlbnRyeS50b1VSTCgpLCBmaWxlLnR5cGUpLnRoZW4oXG4gICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHEucmVzb2x2ZSgpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgcS5yZWplY3QoZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmYWlsOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBxLnJlamVjdChlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBmaWxlLmZ1bGxQYXRoID0gYXBpLmdldEZpbGVGdWxsUGF0aChmaWxlLnBhdGgpO1xuICAgICAgICBhcGkuZ2V0RmlsZUVudHJ5KGZpbGUuZnVsbFBhdGgpXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZW50cnkpIHtcbiAgICAgICAgICAgIGNiX2VudHJ5LnN1Y2Nlc3MoZW50cnkpO1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGNiX2VudHJ5LmZhaWwoZSk7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHEucHJvbWlzZTtcbiAgICAgIH07XG4gICAgICBcbiAgICAgIGZ1bmN0aW9uIGRvd25sb2FkKGZpbGUpIHtcbiAgICAgICAgdmFyIHEgPSAkcS5kZWZlcigpO1xuICAgICAgICB2YXIgZnQgPSBuZXcgRmlsZVRyYW5zZmVyKCk7XG4gICAgICAgIHZhciB1cmkgPSBlbmNvZGVVUkkoZmlsZS51cmwpO1xuICAgICAgICBcbiAgICAgICAgZmlsZS5zdGF0dXMgPSBzdGF0dXNlcy5kb3dubG9hZGluZztcbiAgICAgICAgZmlsZS5mdWxsUGF0aCA9IGFwaS5nZXRGaWxlRnVsbFBhdGgoZmlsZS5wYXRoKTtcbiAgICAgICAgZmlsZVRyYW5zZmVyc1tmaWxlLnBhdGhdID0gZnQ7XG5cbiAgICAgICAgZnQub25wcm9ncmVzcyA9IGZ1bmN0aW9uIChwcm9ncmVzcykge1xuICAgICAgICAgIHEubm90aWZ5KHByb2dyZXNzKTtcbiAgICAgICAgfTtcblxuICAgICAgICBxLnByb21pc2UuYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgZnQuYWJvcnQoKTtcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgY2JfZG93bmxvYWQgPSB7XG4gICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZmlsZUVudHJ5KSB7XG4gICAgICAgICAgICBmaWxlLnN0YXR1cyA9IHN0YXR1c2VzLmRvd25sb2FkZWQ7XG5cdFx0XHRcdFx0XHRhcGkuYWRkRmlsZShmaWxlKTtcblx0XHRcdFx0XHRcdGRlbGV0ZSBmaWxlVHJhbnNmZXJzW2ZpbGUucGF0aF07XG4gICAgICAgICAgICBxLnJlc29sdmUoZmlsZSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmYWlsOiBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgJGxvZy5kZWJ1ZyhlcnJvcik7XG4gICAgICAgICAgICBmaWxlLnN0YXR1cyA9IHN0YXR1c2VzLmRvd25sb2FkO1xuICAgICAgICAgICAgZXJyb3IgPSBhcGkuZmlsZVRyYW5zZmVyRXJyb3JIYW5kbGVyKGVycm9yKTtcblx0XHRcdFx0XHRcdGRlbGV0ZSBmaWxlVHJhbnNmZXJzW2ZpbGUucGF0aF07XG5cdFx0XHRcdFx0XHRxLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmdC5kb3dubG9hZCh1cmksIGZpbGUuZnVsbFBhdGgsIGNiX2Rvd25sb2FkLnN1Y2Nlc3MsIGNiX2Rvd25sb2FkLmZhaWwsIGZhbHNlKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBxLnByb21pc2U7XG4gICAgICB9O1xuICAgICAgXG4gICAgICBmdW5jdGlvbiByZW1vdmUoZmlsZSkge1xuICAgICAgICB2YXIgcSA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgZmlsZS5mdWxsUGF0aCA9IGFwaS5nZXRGaWxlRnVsbFBhdGgoZmlsZS5wYXRoKTtcbiAgICAgICAgYXBpLmdldEZpbGVFbnRyeShmaWxlLmZ1bGxQYXRoKVxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgICAgICBlbnRyeS5yZW1vdmUoXG4gICAgICAgICAgICAgIGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgICAgICAgICAgICBhcGkucmVtb3ZlRmlsZShmaWxlLnBhdGgpO1xuICAgICAgICAgICAgICAgIGZpbGUuc3RhdHVzID0gc3RhdHVzZXMuZG93bmxvYWQ7XG4gICAgICAgICAgICAgICAgcS5yZXNvbHZlKGZpbGUpO1xuICAgICAgICAgICAgICB9LGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHEucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgZmlsZS5zdGF0dXMgPSBzdGF0dXNlcy5kb3dubG9hZDtcbiAgICAgICAgICAgIHEucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcS5wcm9taXNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBmdW5jdGlvbiBkZWNvcmF0ZUZpbGUoZmlsZSkge1xuICAgICAgICBmaWxlLm5hbWUgPSBmaWxlLm5hbWUgfHwgYXBpLmdldEZpbGVOYW1lKGZpbGUpO1xuICAgICAgICBmaWxlLnBhdGggPSBmaWxlLnBhdGggfHwgYXBpLmdldEZpbGVQYXRoKGZpbGUubmFtZSk7XG4gICAgICAgIGZpbGUuc3RhdHVzID0gYXBpLmdldEZpbGVTdGF0dXMoZmlsZS5wYXRoKTtcbiAgICAgICAgXG4gICAgICAgIC8qXG4gICAgICAgICAgSWYgZGV2aWNlIG5vdCBleGlzdHMgdGhlbiBhcHAgcnVuIG9uIGJyb3dzZXJcbiAgICAgICAgKi9cbiAgICAgICAgaWYgKCF0eXBlb2YoZGV2aWNlKSkge1xuICAgICAgICAgIHZhciBmdWxsUGF0aCA9IGFwaS5nZXRGaWxlRnVsbFBhdGgoZmlsZS5wYXRoKTtcbiAgICAgICAgICBpZiAoYXBpLmlzRG93bmxvYWRlZChmdWxsUGF0aCkpXG4gICAgICAgICAgICBmaWxlLmZ1bGxQYXRoID0gZnVsbFBhdGg7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICB9O1xuICAgIH07XG4gIH07XG4gIFxuXHRmdW5jdGlvbiBtZWRpYUNsaWNrTGFiZWwoTUlNRVMpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0cmV0dXJuIE1JTUVTW3R5cGVdID8gTUlNRVNbdHlwZV0ubGFiZWwgOiAnT3Blbic7XG5cdFx0fTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gbWVkaWFJY29uQ2xhc3MoTUlNRVMpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0cmV0dXJuIE1JTUVTW3R5cGVdID8gTUlNRVNbdHlwZV0uY2xhc3MgOiAnZmEtZXh0ZXJuYWwtbGluayc7XG5cdFx0fTtcblx0fVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyXG5cdC5tb2R1bGUoJ25nTWV1bW9iaS5VdGlscy5kaWFsb2dzJywgW10pXG5cdC5mYWN0b3J5KCdtZXVEaWFsb2dzJywgbWV1RGlhbG9ncyk7XG4gIFxuICAvKlxuICAgIGluc3RhbGwgICA6ICAgICBjb3Jkb3ZhIHBsdWdpbiBhZGQgY29yZG92YS1wbHVnaW4tZGlhbG9ncyBubC54LXNlcnZpY2VzLnBsdWdpbnMudG9hc3RcbiAgICBsaW5rICAgICAgOiAgICAgaHR0cHM6Ly9naXRodWIuY29tL2FwYWNoZS9jb3Jkb3ZhLXBsdWdpbi1kaWFsb2dzXG4gICAgbGluayAgICAgIDogICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9FZGR5VmVyYnJ1Z2dlbi9Ub2FzdC1QaG9uZUdhcC1QbHVnaW4gIFxuICAqL1xuICBcbiAgZnVuY3Rpb24gbWV1RGlhbG9ncygkcSwgJHdpbmRvdykge1xuICAgIFxuICAgIHZhciBzZXJ2aWNlID0ge307XG4gICAgXG4gICAgc2VydmljZS5hbGVydCA9IGFsZXJ0O1xuICAgIHNlcnZpY2UuY29uZmlybSA9IGNvbmZpcm07XG4gICAgc2VydmljZS50b2FzdCA9IHRvYXN0O1xuICAgIFxuICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIFxuICAgIGZ1bmN0aW9uIGFsZXJ0IChtZXNzYWdlLCB0aXRsZSwgYnV0dG9uTmFtZSkge1xuICAgICAgdmFyIHEgPSAkcS5kZWZlcigpO1xuXG4gICAgICBpZiAoISR3aW5kb3cubmF2aWdhdG9yLm5vdGlmaWNhdGlvbikge1xuICAgICAgICAkd2luZG93LmFsZXJ0KG1lc3NhZ2UpO1xuICAgICAgICBxLnJlc29sdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5hdmlnYXRvci5ub3RpZmljYXRpb24uYWxlcnQobWVzc2FnZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHEucmVzb2x2ZSgpO1xuICAgICAgICB9LCB0aXRsZSwgYnV0dG9uTmFtZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBxLnByb21pc2U7XG4gICAgfTtcbiAgICBcbiAgICBmdW5jdGlvbiBjb25maXJtIChtZXNzYWdlLCB0aXRsZSwgYnV0dG9uTGFiZWxzKSB7XG4gICAgICB2YXIgcSA9ICRxLmRlZmVyKCk7XG5cbiAgICAgIGlmICghJHdpbmRvdy5uYXZpZ2F0b3Iubm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGlmICgkd2luZG93LmNvbmZpcm0obWVzc2FnZSkpIHtcbiAgICAgICAgICBxLnJlc29sdmUoMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcS5yZXNvbHZlKDIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuYXZpZ2F0b3Iubm90aWZpY2F0aW9uLmNvbmZpcm0obWVzc2FnZSwgZnVuY3Rpb24gKGJ1dHRvbkluZGV4KSB7XG4gICAgICAgICAgcS5yZXNvbHZlKGJ1dHRvbkluZGV4KTtcbiAgICAgICAgfSwgdGl0bGUsIGJ1dHRvbkxhYmVscyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBxLnByb21pc2U7XG4gICAgfTtcbiAgICBcbiAgICBmdW5jdGlvbiB0b2FzdCAobWVzc2FnZSkge1xuICAgICAgdmFyIHEgPSAkcS5kZWZlcigpO1xuXHRcdFx0dmFyIHRvYXN0ID0gJHdpbmRvdy5wbHVnaW5zICYmICR3aW5kb3cucGx1Z2lucy50b2FzdDtcbiAgICAgIFxuXHRcdFx0aWYgKHRvYXN0KSB7XG4gICAgICAgIHRvYXN0LnNob3dMb25nQm90dG9tKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgIHEucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgIHEucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhbGVydChtZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHEucHJvbWlzZTtcbiAgICB9O1xuICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXJcblx0Lm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzLmNhbGVuZGFyJywgW10pXG5cdC5mYWN0b3J5KCdtZXVDYWxlbmRhcicsIFsnJHEnLCAnJHdpbmRvdycsICdzdHJpcHRhZ3NGaWx0ZXInLCAnYnIybmxGaWx0ZXInLCBtZXVDYWxlbmRhcl0pO1xuICBcbiAgLypcbiAgICBjb3Jkb3ZhIHBsdWdpbiBhZGQgaHR0cHM6Ly9naXRodWIuY29tL0VkZHlWZXJicnVnZ2VuL0NhbGVuZGFyLVBob25lR2FwLVBsdWdpbi5naXRcbiAgICBJZiBzdGFydCBhbmQgZW5kX2RhdGUgZXF1YWwgMDA6MDAgdGhlbiB0aGUgZXZlbnQgb2NjdXJzIGFsbCBkYXkgbG9uZ1xuICAqL1xuICBcbiAgZnVuY3Rpb24gbWV1Q2FsZW5kYXIoJHEsICR3aW5kb3csIHN0cmlwdGFncywgYnIybmwpIHtcbiAgICBcbiAgICB2YXIgc2VydmljZSA9IHt9O1xuICAgIFxuICAgIHNlcnZpY2UuY3JlYXRlRXZlbnRJbnRlcmFjdGl2ZWx5ID0gY3JlYXRlRXZlbnRJbnRlcmFjdGl2ZWx5O1xuICAgIFxuICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIFxuICAgIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50SW50ZXJhY3RpdmVseShvcHRpb25zKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCksXG4gICAgICAgIGRlZmF1bHRPcHRpb25zID0ge1xuICAgICAgICAgIHRpdGxlOiBudWxsLFxuICAgICAgICAgIGFkZHJlc3M6IG51bGwsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICcnLFxuICAgICAgICAgIHN0YXJ0X2RhdGU6IG51bGwsXG4gICAgICAgICAgZW5kX2RhdGU6IG51bGxcbiAgICAgICAgfTtcblxuICAgICAgZGVmYXVsdE9wdGlvbnMgPSBhbmd1bGFyLmV4dGVuZChkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgICAgICR3aW5kb3cucGx1Z2lucy5jYWxlbmRhci5jcmVhdGVFdmVudEludGVyYWN0aXZlbHkoXG4gICAgICAgIHN0cmlwdGFncyhkZWZhdWx0T3B0aW9ucy50aXRsZSksXG4gICAgICAgIHN0cmlwdGFncyhkZWZhdWx0T3B0aW9ucy5hZGRyZXNzKSxcbiAgICAgICAgc3RyaXB0YWdzKGJyMm5sKGRlZmF1bHRPcHRpb25zLmRlc2NyaXB0aW9uKSksXG4gICAgICAgIG5ldyBEYXRlKGRlZmF1bHRPcHRpb25zLnN0YXJ0X2RhdGUgICogMTAwMCksXG4gICAgICAgIG5ldyBEYXRlKGRlZmF1bHRPcHRpb25zLmVuZF9kYXRlICAqIDEwMDApLFxuICAgICAgICBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICAgIGQucmVzb2x2ZShtZXNzYWdlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cbiAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG5cdCd1c2Ugc3RyaWN0JztcbiAgXG5cdGFuZ3VsYXJcblx0Lm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzLmFuYWx5dGljcycsIFtdKVxuXHQuZmFjdG9yeSgnZ29vZ2xlQW5hbHl0aWNzQ29yZG92YScsIGdvb2dsZUFuYWx5dGljc0NvcmRvdmEpXG5cdC5mYWN0b3J5KCdnb29nbGVBbmFseXRpY3MnLCBnb29nbGVBbmFseXRpY3MpXG4gIC5mYWN0b3J5KCckY29yZG92YUdvb2dsZUFuYWx5dGljcycsICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzKVxuXHQuZmFjdG9yeSgnbWV1QW5hbHl0aWNzJywgbWV1QW5hbHl0aWNzKTtcbiAgXG4gIC8qXG4gICAgSW5zcGlyZWQgYnkgbmdDb3Jkb3ZhXG4gICAgV2UndmUgZXh0cmFjdGVkIG9ubHkgcmVxdWlyZWQgbWV0aG9kcyBcbiAgXG4gICAgaW5zdGFsbCAgIDogICAgIGNvcmRvdmEgcGx1Z2luIGFkZCBodHRwczovL2dpdGh1Yi5jb20vZGFud2lsc29uL2dvb2dsZS1hbmFseXRpY3MtcGx1Z2luLmdpdFxuICAqL1xuXG4gIGZ1bmN0aW9uICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzKCRxLCAkd2luZG93LCAkbG9nKSB7XG4gICAgXG4gICAgdmFyIHNlcnZpY2UgPSB7fTtcbiAgICBcbiAgICBzZXJ2aWNlLnN0YXJ0VHJhY2tlcldpdGhJZCA9IHN0YXJ0VHJhY2tlcldpdGhJZDtcbiAgICBzZXJ2aWNlLmRlYnVnTW9kZSA9IGRlYnVnTW9kZTtcbiAgICBzZXJ2aWNlLnRyYWNrVmlldyA9IHRyYWNrVmlldztcbiAgICBzZXJ2aWNlLnRyYWNrRXZlbnQgPSB0cmFja0V2ZW50O1xuICAgIHNlcnZpY2Uuc2V0VXNlcklkID0gc2V0VXNlcklkO1xuICAgIFxuICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgZnVuY3Rpb24gc2V0VXNlcklkKGlkKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICRsb2cuZGVidWcoJ1NldCBVc2VyIElkOiAnICsgaWQpO1xuICAgICAgXG4gICAgICAkd2luZG93LmFuYWx5dGljcy5zZXRVc2VySWQoaWQsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0YXJ0VHJhY2tlcldpdGhJZChpZCkge1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAkbG9nLmRlYnVnKCdTdGFydCB0cmFja2luZyBHQSBJZDogJyArIGlkKTtcblxuICAgICAgJHdpbmRvdy5hbmFseXRpY3Muc3RhcnRUcmFja2VyV2l0aElkKGlkLCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgZC5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBkLnJlamVjdChlcnJvcik7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBkZWJ1Z01vZGUoKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICR3aW5kb3cuYW5hbHl0aWNzLmRlYnVnTW9kZShmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgZC5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZC5yZWplY3QoKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyYWNrVmlldyhzY3JlZW5OYW1lKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICBcbiAgICAgICRsb2cuZGVidWcoJ1RyYWNrIFZpZXc6ICcgKyBzY3JlZW5OYW1lKTtcbiAgICAgIFxuICAgICAgJHdpbmRvdy5hbmFseXRpY3MudHJhY2tWaWV3KHNjcmVlbk5hbWUsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRyYWNrRXZlbnQoY2F0ZWdvcnksIGFjdGlvbiwgbGFiZWwsIHZhbHVlKSB7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgIHZhciBldiA9IFtjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWVdO1xuICAgICAgJGxvZy5kZWJ1ZygnVHJhY2sgRXZlbnQ6ICcgKyBldi50b1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgJHdpbmRvdy5hbmFseXRpY3MudHJhY2tFdmVudChjYXRlZ29yeSwgYWN0aW9uLCBsYWJlbCwgdmFsdWUsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBkLnJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGQucmVqZWN0KGVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZC5wcm9taXNlO1xuICAgIH1cbiAgfVxuXHRcdFxuXHRmdW5jdGlvbiBnb29nbGVBbmFseXRpY3NDb3Jkb3ZhKCRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzLCAkbG9nKSB7XG4gICAgXG4gICAgdmFyIHNlcnZpY2UgPSB7fTtcbiAgICBcbiAgICBzZXJ2aWNlLmluaXQgPSBpbml0O1xuICAgIHNlcnZpY2UuZGVidWdNb2RlID0gJGNvcmRvdmFHb29nbGVBbmFseXRpY3MuZGVidWdNb2RlO1xuICAgIHNlcnZpY2UudHJhY2tWaWV3ID0gJGNvcmRvdmFHb29nbGVBbmFseXRpY3MudHJhY2tWaWV3O1xuICAgIHNlcnZpY2UudHJhY2tFdmVudCA9ICRjb3Jkb3ZhR29vZ2xlQW5hbHl0aWNzLnRyYWNrRXZlbnQ7XG4gICAgc2VydmljZS5zdGFydFRyYWNrZXJXaXRoSWQgPSAkY29yZG92YUdvb2dsZUFuYWx5dGljcy5zdGFydFRyYWNrZXJXaXRoSWQ7XG4gICAgc2VydmljZS5zZXRVc2VySWQgPSAkY29yZG92YUdvb2dsZUFuYWx5dGljcy5zZXRVc2VySWQ7XG4gICAgXG4gICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgXG4gICAgZnVuY3Rpb24gaW5pdCh0cmFja0lkKSB7XG4gICAgICAkY29yZG92YUdvb2dsZUFuYWx5dGljcy5zdGFydFRyYWNrZXJXaXRoSWQodHJhY2tJZCk7XG4gICAgfVxuXHR9XG4gIFxuXHRmdW5jdGlvbiBnb29nbGVBbmFseXRpY3MoJGxvZywgJHEpIHtcbiAgICBcbiAgICB2YXIgc2VydmljZSA9IHt9O1xuICAgIFxuICAgIHNlcnZpY2UuaW5pdCA9IGluaXQ7XG4gICAgc2VydmljZS5kZWJ1Z01vZGUgPSBkZWJ1Z01vZGU7XG4gICAgc2VydmljZS50cmFja1ZpZXcgPSB0cmFja1ZpZXc7XG4gICAgc2VydmljZS50cmFja0V2ZW50ID0gdHJhY2tFdmVudDtcbiAgICBzZXJ2aWNlLnN0YXJ0VHJhY2tlcldpdGhJZCAgPSBzdGFydFRyYWNrZXJXaXRoSWQ7XG4gICAgc2VydmljZS5zZXRVc2VySWQgPSBzZXRVc2VySWQ7XG4gICAgXG4gICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgXG4gICAgZnVuY3Rpb24gaW5pdCh0cmFja0lkKSB7XG4gICAgICAkbG9nLmRlYnVnKCdHb29nbGUgQW5hbHl0aWNzIHRyYWNrIElkOiAnICsgdHJhY2tJZCk7XG4gICAgfVxuICAgIFxuICAgIGZ1bmN0aW9uIGRlYnVnTW9kZSgpIHtcbiAgICAgICRsb2cuZGVidWcoJ0VuYWJsZSBEZWJ1ZycpO1xuICAgIH1cbiAgICBcbiAgICBmdW5jdGlvbiB0cmFja1ZpZXcodGl0bGUpIHtcbiAgICAgICRsb2cuZGVidWcoJ1RyYWNraW5nIFBhZ2U6ICcgKyB0aXRsZSk7XG4gICAgfVxuICAgIFxuICAgIGZ1bmN0aW9uIHRyYWNrRXZlbnQoY2F0ZWdvcnksIGFjdGlvbiwgbGFiZWwsIHZhbHVlKSB7XG4gICAgICAkbG9nLmRlYnVnKCdUcmFja2luZyBFdmVudDogJyArIGFjdGlvbik7XG4gICAgfVxuICAgIFxuICAgIGZ1bmN0aW9uIHN0YXJ0VHJhY2tlcldpdGhJZChpZCkge1xuICAgICAgdmFyIG1zZyA9ICdUcmFja2luZyBHQSBJZDogJyArIGlkO1xuICAgICAgdmFyIGQgPSAkcS5kZWZlcigpO1xuXG4gICAgICBkLnJlc29sdmUobXNnKTtcblxuICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICB9XG4gICAgXG4gICAgZnVuY3Rpb24gc2V0VXNlcklkKGlkKSB7XG4gICAgICAkbG9nLmRlYnVnKCdUcmFja2luZyBVc2VyOiAnICsgaWQpO1xuICAgIH1cblx0fVxuICBcblx0ZnVuY3Rpb24gbWV1QW5hbHl0aWNzKCRpbmplY3RvciwgJHdpbmRvdykge1xuXG5cdFx0aWYgKCR3aW5kb3cuY29yZG92YSkge1xuXHRcdFx0cmV0dXJuICRpbmplY3Rvci5nZXQoJ2dvb2dsZUFuYWx5dGljc0NvcmRvdmEnKTtcblx0XHR9IGVsc2Uge1xuXHRcdCAgcmV0dXJuICRpbmplY3Rvci5nZXQoJ2dvb2dsZUFuYWx5dGljcycpO1xuXHRcdH1cblx0fVxufSkoKTsiLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuLyogZXNsaW50IG5vLXVuZGVmOiBcImVycm9yXCIgKi9cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzLmZpbHRlcnMnLCBbXSlcbiAgLmZpbHRlcignaXNFbXB0eScsIGlzRW1wdHkpXG4gIC5maWx0ZXIoJ2JyMm5sJywgYnIybmwpXG4gIC5maWx0ZXIoJ3N0cmlwdGFncycsIHN0cmlwdGFncyk7XG5cbiAgZnVuY3Rpb24gaXNFbXB0eSgpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikge1xuICAgICAgcmV0dXJuICFPYmplY3Qua2V5cyhvYmopLmxlbmd0aDtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gYnIybmwoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKC88YnJcXHMqW1xcL10/Pi9naSwgJ1xcbicpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBzdHJpcHRhZ3MoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICByZXR1cm4gYW5ndWxhclxuICAgICAgICAgIC5lbGVtZW50KCc8ZGl2Lz4nKVxuICAgICAgICAgIC5odG1sKHRleHQpXG4gICAgICAgICAgLnRleHQoKTtcbiAgICB9O1xuICB9XG59KSgpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cbi8qIGVzbGludCBuby11bmRlZjogXCJlcnJvclwiICovXG4vKlxuICBUT0RPOiBzaG91bGQgcmVsZWFzZSBtaW5pZmllZCAoLm1pbi5qcykgYW5kIG5vdCAoLmpzKVxuKi9cbihmdW5jdGlvbiAoKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnbmdNZXVtb2JpLlV0aWxzJywgW1xuICAgIC8vJ25nTWV1bW9iaS5VdGlscy5maWxlcycsXG4gICAgLy8nbmdNZXVtb2JpLlV0aWxzLmFwaScsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5sb2FkaW5nJyxcbiAgICAvLyduZ01ldW1vYmkuVXRpbHMuY29ubmVjdGlvbicsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5jYWxlbmRhcicsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5hbmFseXRpY3MnLFxuICAgICduZ01ldW1vYmkuVXRpbHMuc29jaWFsU2hhcmluZycsXG4gICAgJ25nTWV1bW9iaS5VdGlscy5kaWFsb2dzJyxcbiAgICAnbmdNZXVtb2JpLlV0aWxzLmZpbGVzJ1xuICAgIC8vJ25nTWV1bW9iaS5VdGlscy5maWx0ZXJzJ1xuICBdKTtcbiAgXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
